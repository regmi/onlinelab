(function(){if(typeof jQuery!="undefined")
var _jQuery=jQuery;var jQuery=window.jQuery=function(selector,context){return this instanceof jQuery?this.init(selector,context):new jQuery(selector,context);};if(typeof $!="undefined")
var _$=$;window.$=jQuery;var quickExpr=/^[^<]*(<(.|\s)+>)[^>]*$|^#(\w+)$/;jQuery.fn=jQuery.prototype={init:function(selector,context){selector=selector||document;if(typeof selector=="string"){var match=quickExpr.exec(selector);if(match&&(match[1]||!context)){if(match[1])
selector=jQuery.clean([match[1]],context);else{var elem=document.getElementById(match[3]);if(elem)
if(elem.id!=match[3])
return jQuery().find(selector);else{this[0]=elem;this.length=1;return this;}
else
selector=[];}}else
return new jQuery(context).find(selector);}else if(jQuery.isFunction(selector))
return new jQuery(document)[jQuery.fn.ready?"ready":"load"](selector);return this.setArray(selector.constructor==Array&&selector||(selector.jquery||selector.length&&selector!=window&&!selector.nodeType&&selector[0]!=undefined&&selector[0].nodeType)&&jQuery.makeArray(selector)||[selector]);},jquery:"1.2.1",size:function(){return this.length;},length:0,get:function(num){return num==undefined?jQuery.makeArray(this):this[num];},pushStack:function(elems){var ret=jQuery(elems);ret.prevObject=this;return ret;},setArray:function(elems){this.length=0;Array.prototype.push.apply(this,elems);return this;},each:function(callback,args){return jQuery.each(this,callback,args);},index:function(elem){var ret=-1;this.each(function(i){if(this==elem)
ret=i;});return ret;},attr:function(name,value,type){var options=name;if(name.constructor==String)
if(value==undefined)
return this.length&&jQuery[type||"attr"](this[0],name)||undefined;else{options={};options[name]=value;}
return this.each(function(i){for(name in options)
jQuery.attr(type?this.style:this,name,jQuery.prop(this,options[name],type,i,name));});},css:function(key,value){return this.attr(key,value,"curCSS");},text:function(text){if(typeof text!="object"&&text!=null)
return this.empty().append(document.createTextNode(text));var ret="";jQuery.each(text||this,function(){jQuery.each(this.childNodes,function(){if(this.nodeType!=8)
ret+=this.nodeType!=1?this.nodeValue:jQuery.fn.text([this]);});});return ret;},wrapAll:function(html){if(this[0])
jQuery(html,this[0].ownerDocument).clone().insertBefore(this[0]).map(function(){var elem=this;while(elem.firstChild)
elem=elem.firstChild;return elem;}).append(this);return this;},wrapInner:function(html){return this.each(function(){jQuery(this).contents().wrapAll(html);});},wrap:function(html){return this.each(function(){jQuery(this).wrapAll(html);});},append:function(){return this.domManip(arguments,true,false,function(elem){this.appendChild(elem);});},prepend:function(){return this.domManip(arguments,true,true,function(elem){this.insertBefore(elem,this.firstChild);});},before:function(){return this.domManip(arguments,false,false,function(elem){this.parentNode.insertBefore(elem,this);});},after:function(){return this.domManip(arguments,false,true,function(elem){this.parentNode.insertBefore(elem,this.nextSibling);});},end:function(){return this.prevObject||jQuery([]);},find:function(selector){var elems=jQuery.map(this,function(elem){return jQuery.find(selector,elem);});return this.pushStack(/[^+>] [^+>]/.test(selector)||selector.indexOf("..")>-1?jQuery.unique(elems):elems);},clone:function(events){var ret=this.map(function(){return this.outerHTML?jQuery(this.outerHTML)[0]:this.cloneNode(true);});var clone=ret.find("*").andSelf().each(function(){if(this[expando]!=undefined)
this[expando]=null;});if(events===true)
this.find("*").andSelf().each(function(i){var events=jQuery.data(this,"events");for(var type in events)
for(var handler in events[type])
jQuery.event.add(clone[i],type,events[type][handler],events[type][handler].data);});return ret;},filter:function(selector){return this.pushStack(jQuery.isFunction(selector)&&jQuery.grep(this,function(elem,i){return selector.call(elem,i);})||jQuery.multiFilter(selector,this));},not:function(selector){return this.pushStack(selector.constructor==String&&jQuery.multiFilter(selector,this,true)||jQuery.grep(this,function(elem){return selector.constructor==Array||selector.jquery?jQuery.inArray(elem,selector)<0:elem!=selector;}));},add:function(selector){return this.pushStack(jQuery.merge(this.get(),selector.constructor==String?jQuery(selector).get():selector.length!=undefined&&(!selector.nodeName||jQuery.nodeName(selector,"form"))?selector:[selector]));},is:function(selector){return selector?jQuery.multiFilter(selector,this).length>0:false;},hasClass:function(selector){return this.is("."+selector);},val:function(value){if(value==undefined){if(this.length){var elem=this[0];if(jQuery.nodeName(elem,"select")){var index=elem.selectedIndex,values=[],options=elem.options,one=elem.type=="select-one";if(index<0)
return null;for(var i=one?index:0,max=one?index+1:options.length;i<max;i++){var option=options[i];if(option.selected){value=jQuery.browser.msie&&!option.attributes.value.specified?option.text:option.value;if(one)
return value;values.push(value);}}
return values;}else
return this[0].value.replace(/\r/g,"");}}else
return this.each(function(){if(value.constructor==Array&&/radio|checkbox/.test(this.type))
this.checked=(jQuery.inArray(this.value,value)>=0||jQuery.inArray(this.name,value)>=0);else if(jQuery.nodeName(this,"select")){var values=value.constructor==Array?value:[value];jQuery("option",this).each(function(){this.selected=(jQuery.inArray(this.value,values)>=0||jQuery.inArray(this.text,values)>=0);});if(!tmp.length)
this.selectedIndex=-1;}else
this.value=value;});},html:function(value){return value==undefined?(this.length?this[0].innerHTML:null):this.empty().append(value);},replaceWith:function(value){return this.after(value).remove();},eq:function(i){return this.slice(i,i+1);},slice:function(){return this.pushStack(Array.prototype.slice.apply(this,arguments));},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem);}));},andSelf:function(){return this.add(this.prevObject);},domManip:function(args,table,reverse,callback){var clone=this.length>1,elems;return this.each(function(){if(!elems){elems=jQuery.clean(args,this.ownerDocument);if(reverse)
elems.reverse();}
var obj=this;if(table&&jQuery.nodeName(this,"table")&&jQuery.nodeName(elems[0],"tr"))
obj=this.getElementsByTagName("tbody")[0]||this.appendChild(document.createElement("tbody"));jQuery.each(elems,function(){var elem=clone?this.cloneNode(true):this;if(!evalScript(0,elem))
callback.call(obj,elem);});});}};function evalScript(i,elem){var script=jQuery.nodeName(elem,"script");if(script){if(elem.src)
jQuery.ajax({url:elem.src,async:false,dataType:"script"});else
jQuery.globalEval(elem.text||elem.textContent||elem.innerHTML||"");if(elem.parentNode)
elem.parentNode.removeChild(elem);}else if(elem.nodeType==1)
jQuery("script",elem).each(evalScript);return script;}
jQuery.extend=jQuery.fn.extend=function(){var target=arguments[0]||{},i=1,length=arguments.length,deep=false,options;if(target.constructor==Boolean){deep=target;target=arguments[1]||{};}
if(length==1){target=this;i=0;}
for(;i<length;i++)
if((options=arguments[i])!=null)
for(var name in options){if(target==options[name])
continue;if(deep&&typeof options[name]=="object"&&target[name])
jQuery.extend(target[name],options[name]);else if(options[name]!=undefined)
target[name]=options[name];}
return target;};var expando="jQuery"+(new Date()).getTime(),uuid=0,windowData={};var exclude=/z-?index|font-?weight|opacity|zoom|line-?height/i;jQuery.extend({noConflict:function(deep){window.$=_$;if(deep)
window.jQuery=_jQuery;return jQuery;},isFunction:function(fn){return!!fn&&typeof fn!="string"&&!fn.nodeName&&fn.constructor!=Array&&/function/i.test(fn+"");},isXMLDoc:function(elem){return elem.documentElement&&!elem.body||elem.tagName&&elem.ownerDocument&&!elem.ownerDocument.body;},globalEval:function(data){data=jQuery.trim(data);if(data){var head=document.getElementsByTagName("head")[0]||document.documentElement,script=document.createElement("script");script.type="text/javascript";if(jQuery.browser.msie)
script.text=data;else
script.appendChild(document.createTextNode(data));head.appendChild(script);head.removeChild(script);}},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toUpperCase()==name.toUpperCase();},cache:{},data:function(elem,name,data){elem=elem==window?windowData:elem;var id=elem[expando];if(!id)
id=elem[expando]=++uuid;if(name&&!jQuery.cache[id])
jQuery.cache[id]={};if(data!=undefined)
jQuery.cache[id][name]=data;return name?jQuery.cache[id][name]:id;},removeData:function(elem,name){elem=elem==window?windowData:elem;var id=elem[expando];if(name){if(jQuery.cache[id]){delete jQuery.cache[id][name];name="";for(name in jQuery.cache[id])
break;if(!name)
jQuery.removeData(elem);}}else{try{delete elem[expando];}catch(e){if(elem.removeAttribute)
elem.removeAttribute(expando);}
delete jQuery.cache[id];}},each:function(object,callback,args){if(args){if(object.length==undefined)
for(var name in object)
callback.apply(object[name],args);else
for(var i=0,length=object.length;i<length;i++)
if(callback.apply(object[i],args)===false)
break;}else{if(object.length==undefined)
for(var name in object)
callback.call(object[name],name,object[name]);else
for(var i=0,length=object.length,value=object[0];i<length&&callback.call(value,i,value)!==false;value=object[++i]){}}
return object;},prop:function(elem,value,type,i,name){if(jQuery.isFunction(value))
value=value.call(elem,i);return value&&value.constructor==Number&&type=="curCSS"&&!exclude.test(name)?value+"px":value;},className:{add:function(elem,classNames){jQuery.each((classNames||"").split(/\s+/),function(i,className){if(!jQuery.className.has(elem.className,className))
elem.className+=(elem.className?" ":"")+className;});},remove:function(elem,classNames){elem.className=classNames!=undefined?jQuery.grep(elem.className.split(/\s+/),function(className){return!jQuery.className.has(classNames,className);}).join(" "):"";},has:function(elem,className){return jQuery.inArray(className,(elem.className||elem).toString().split(/\s+/))>-1;}},swap:function(elem,options,callback){for(var name in options){elem.style["old"+name]=elem.style[name];elem.style[name]=options[name];}
callback.call(elem);for(var name in options)
elem.style[name]=elem.style["old"+name];},css:function(elem,name){if(name=="height"||name=="width"){var old={},height,width;jQuery.each(["Top","Bottom","Right","Left"],function(){old["padding"+this]=0;old["border"+this+"Width"]=0;});jQuery.swap(elem,old,function(){if(jQuery(elem).is(":visible")){height=elem.offsetHeight;width=elem.offsetWidth;}else{elem=jQuery(elem.cloneNode(true)).find(":radio").removeAttr("checked").end().css({visibility:"hidden",position:"absolute",display:"block",right:"0",left:"0"}).appendTo(elem.parentNode)[0];var position=jQuery.css(elem.parentNode,"position")||"static";if(position=="static")
elem.parentNode.style.position="relative";height=elem.clientHeight;width=elem.clientWidth;if(position=="static")
elem.parentNode.style.position="static";elem.parentNode.removeChild(elem);}});return name=="height"?height:width;}
return jQuery.curCSS(elem,name);},curCSS:function(elem,name,force){var ret;function color(elem){if(!jQuery.browser.safari)
return false;var ret=document.defaultView.getComputedStyle(elem,null);return!ret||ret.getPropertyValue("color")=="";}
if(name=="opacity"&&jQuery.browser.msie){ret=jQuery.attr(elem.style,"opacity");return ret==""?"1":ret;}
if(name.match(/float/i))
name=styleFloat;if(!force&&elem.style[name])
ret=elem.style[name];else if(document.defaultView&&document.defaultView.getComputedStyle){if(name.match(/float/i))
name="float";name=name.replace(/([A-Z])/g,"-$1").toLowerCase();var getComputedStyle=document.defaultView.getComputedStyle(elem,null);if(getComputedStyle&&!color(elem))
ret=getComputedStyle.getPropertyValue(name);else{var swap=[],stack=[];for(var a=elem;a&&color(a);a=a.parentNode)
stack.unshift(a);for(var i=0;i<stack.length;i++)
if(color(stack[i])){swap[i]=stack[i].style.display;stack[i].style.display="block";}
ret=name=="display"&&swap[stack.length-1]!=null?"none":document.defaultView.getComputedStyle(elem,null).getPropertyValue(name)||"";for(var i=0;i<swap.length;i++)
if(swap[i]!=null)
stack[i].style.display=swap[i];}
if(name=="opacity"&&ret=="")
ret="1";}else if(elem.currentStyle){var camelCase=name.replace(/\-(\w)/g,function(all,letter){return letter.toUpperCase();});ret=elem.currentStyle[name]||elem.currentStyle[camelCase];if(!/^\d+(px)?$/i.test(ret)&&/^\d/.test(ret)){var style=elem.style.left,runtimeStyle=elem.runtimeStyle.left;elem.runtimeStyle.left=elem.currentStyle.left;elem.style.left=ret||0;ret=elem.style.pixelLeft+"px";elem.style.left=style;elem.runtimeStyle.left=runtimeStyle;}}
return ret;},clean:function(elems,context){var ret=[];context=context||document;jQuery.each(elems,function(i,elem){if(!elem)
return;if(elem.constructor==Number)
elem=elem.toString();if(typeof elem=="string"){elem=elem.replace(/(<(\w+)[^>]*?)\/>/g,function(all,front,tag){return tag.match(/^(abbr|br|col|img|input|link|meta|param|hr|area)$/i)?all:front+"></"+tag+">";});var tags=jQuery.trim(elem).toLowerCase(),div=context.createElement("div");var wrap=!tags.indexOf("<opt")&&[1,"<select>","</select>"]||!tags.indexOf("<leg")&&[1,"<fieldset>","</fieldset>"]||tags.match(/^<(thead|tbody|tfoot|colg|cap)/)&&[1,"<table>","</table>"]||!tags.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!tags.indexOf("<td")||!tags.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||!tags.indexOf("<col")&&[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"]||jQuery.browser.msie&&[1,"div<div>","</div>"]||[0,"",""];div.innerHTML=wrap[1]+elem+wrap[2];while(wrap[0]--)
div=div.lastChild;if(jQuery.browser.msie){var tbody=!tags.indexOf("<table")&&tags.indexOf("<tbody")<0?div.firstChild&&div.firstChild.childNodes:wrap[1]=="<table>"&&tags.indexOf("<tbody")<0?div.childNodes:[];for(var i=tbody.length-1;i>=0;--i)
if(jQuery.nodeName(tbody[i],"tbody")&&!tbody[i].childNodes.length)
tbody[i].parentNode.removeChild(tbody[i]);if(/^\s/.test(elem))
div.insertBefore(context.createTextNode(elem.match(/^\s*/)[0]),div.firstChild);}
elem=jQuery.makeArray(div.childNodes);}
if(elem.length===0&&(!jQuery.nodeName(elem,"form")&&!jQuery.nodeName(elem,"select")))
return;if(elem[0]==undefined||jQuery.nodeName(elem,"form")||elem.options)
ret.push(elem);else
ret=jQuery.merge(ret,elem);});return ret;},attr:function(elem,name,value){var fix=jQuery.isXMLDoc(elem)?{}:jQuery.props;if(name=="selected"&&jQuery.browser.safari)
elem.parentNode.selectedIndex;if(fix[name]){if(value!=undefined)
elem[fix[name]]=value;return elem[fix[name]];}else if(jQuery.browser.msie&&name=="style")
return jQuery.attr(elem.style,"cssText",value);else if(value==undefined&&jQuery.browser.msie&&jQuery.nodeName(elem,"form")&&(name=="action"||name=="method"))
return elem.getAttributeNode(name).nodeValue;else if(elem.tagName){if(value!=undefined){if(name=="type"&&jQuery.nodeName(elem,"input")&&elem.parentNode)
throw"type property can't be changed";elem.setAttribute(name,value);}
if(jQuery.browser.msie&&/href|src/.test(name)&&!jQuery.isXMLDoc(elem))
return elem.getAttribute(name,2);return elem.getAttribute(name);}else{if(name=="opacity"&&jQuery.browser.msie){if(value!=undefined){elem.zoom=1;elem.filter=(elem.filter||"").replace(/alpha\([^)]*\)/,"")+
(parseFloat(value).toString()=="NaN"?"":"alpha(opacity="+value*100+")");}
return elem.filter?(parseFloat(elem.filter.match(/opacity=([^)]*)/)[1])/100).toString():"";}
name=name.replace(/-([a-z])/ig,function(all,letter){return letter.toUpperCase();});if(value!=undefined)
elem[name]=value;return elem[name];}},trim:function(text){return(text||"").replace(/^\s+|\s+$/g,"");},makeArray:function(array){var ret=[];if(typeof array!="array")
for(var i=0,length=array.length;i<length;i++)
ret.push(array[i]);else
ret=array.slice(0);return ret;},inArray:function(elem,array){for(var i=0,length=array.length;i<length;i++)
if(array[i]==elem)
return i;return-1;},merge:function(first,second){if(jQuery.browser.msie){for(var i=0;second[i];i++)
if(second[i].nodeType!=8)
first.push(second[i]);}else
for(var i=0;second[i];i++)
first.push(second[i]);return first;},unique:function(array){var ret=[],done={};try{for(var i=0,length=array.length;i<length;i++){var id=jQuery.data(array[i]);if(!done[id]){done[id]=true;ret.push(array[i]);}}}catch(e){ret=array;}
return ret;},grep:function(elems,callback,inv){if(typeof callback=="string")
callback=eval("false||function(a,i){return "+callback+"}");var ret=[];for(var i=0,length=elems.length;i<length;i++)
if(!inv&&callback(elems[i],i)||inv&&!callback(elems[i],i))
ret.push(elems[i]);return ret;},map:function(elems,callback){var ret=[];for(var i=0,length=elems.length;i<length;i++){var value=callback(elems[i],i);if(value!==null&&value!=undefined){if(value.constructor!=Array)
value=[value];ret=ret.concat(value);}}
return ret;}});var userAgent=navigator.userAgent.toLowerCase();jQuery.browser={version:(userAgent.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],safari:/webkit/.test(userAgent),opera:/opera/.test(userAgent),msie:/msie/.test(userAgent)&&!/opera/.test(userAgent),mozilla:/mozilla/.test(userAgent)&&!/(compatible|webkit)/.test(userAgent)};var styleFloat=jQuery.browser.msie?"styleFloat":"cssFloat";jQuery.extend({boxModel:!jQuery.browser.msie||document.compatMode=="CSS1Compat",props:{"for":"htmlFor","class":"className","float":styleFloat,cssFloat:styleFloat,styleFloat:styleFloat,innerHTML:"innerHTML",className:"className",value:"value",disabled:"disabled",checked:"checked",readonly:"readOnly",selected:"selected",maxlength:"maxLength",selectedIndex:"selectedIndex"}});jQuery.each({parent:"elem.parentNode",parents:"jQuery.dir(elem,'parentNode')",next:"jQuery.nth(elem,2,'nextSibling')",prev:"jQuery.nth(elem,2,'previousSibling')",nextAll:"jQuery.dir(elem,'nextSibling')",prevAll:"jQuery.dir(elem,'previousSibling')",siblings:"jQuery.sibling(elem.parentNode.firstChild,elem)",children:"jQuery.sibling(elem.firstChild)",contents:"jQuery.nodeName(elem,'iframe')?elem.contentDocument||elem.contentWindow.document:jQuery.makeArray(elem.childNodes)"},function(name,fn){fn=eval("false||function(elem){return "+fn+"}");jQuery.fn[name]=function(selector){var ret=jQuery.map(this,fn);if(selector&&typeof selector=="string")
ret=jQuery.multiFilter(selector,ret);return this.pushStack(jQuery.unique(ret));};});jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(){var args=arguments;return this.each(function(){for(var i=0,length=args.length;i<length;i++)
jQuery(args[i])[original](this);});};});jQuery.each({removeAttr:function(name){jQuery.attr(this,name,"");this.removeAttribute(name);},addClass:function(classNames){jQuery.className.add(this,classNames);},removeClass:function(classNames){jQuery.className.remove(this,classNames);},toggleClass:function(classNames){jQuery.className[jQuery.className.has(this,classNames)?"remove":"add"](this,classNames);},remove:function(selector){if(!selector||jQuery.filter(selector,[this]).r.length){jQuery("*",this).add(this).each(function(){jQuery.event.remove(this);jQuery.removeData(this);});this.parentNode.removeChild(this);}},empty:function(){jQuery(">*",this).remove();while(this.firstChild)
this.removeChild(this.firstChild);}},function(name,fn){jQuery.fn[name]=function(){return this.each(fn,arguments);};});jQuery.each(["Height","Width"],function(i,name){var type=name.toLowerCase();jQuery.fn[type]=function(size){return this[0]==window?jQuery.browser.opera&&document.body["client"+name]||jQuery.browser.safari&&self["inner"+name]||document.compatMode=="CSS1Compat"&&document.documentElement["client"+name]||document.body["client"+name]:this[0]==document?Math.max(document.body["scroll"+name],document.body["offset"+name]):size==undefined?(this.length?jQuery.css(this[0],type):null):this.css(type,size.constructor==String?size:size+"px");};});var chars=jQuery.browser.safari&&parseInt(jQuery.browser.version)<417?"(?:[\\w*_-]|\\\\.)":"(?:[\\w\u0128-\uFFFF*_-]|\\\\.)",quickChild=new RegExp("^>\\s*("+chars+"+)"),quickID=new RegExp("^("+chars+"+)(#)("+chars+"+)"),quickClass=new RegExp("^([#.]?)("+chars+"*)");jQuery.extend({expr:{"":"m[2]=='*'||jQuery.nodeName(a,m[2])","#":"a.getAttribute('id')==m[2]",":":{lt:"i<m[3]-0",gt:"i>m[3]-0",nth:"m[3]-0==i",eq:"m[3]-0==i",first:"i==0",last:"i==r.length-1",even:"i%2==0",odd:"i%2","first-child":"a.parentNode.getElementsByTagName('*')[0]==a","last-child":"jQuery.nth(a.parentNode.lastChild,1,'previousSibling')==a","only-child":"!jQuery.nth(a.parentNode.lastChild,2,'previousSibling')",parent:"a.firstChild",empty:"!a.firstChild",contains:"(a.textContent||a.innerText||jQuery(a).text()||'').indexOf(m[3])>=0",visible:'"hidden"!=a.type&&jQuery.css(a,"display")!="none"&&jQuery.css(a,"visibility")!="hidden"',hidden:'"hidden"==a.type||jQuery.css(a,"display")=="none"||jQuery.css(a,"visibility")=="hidden"',enabled:"!a.disabled",disabled:"a.disabled",checked:"a.checked",selected:"a.selected||jQuery.attr(a,'selected')",text:"'text'==a.type",radio:"'radio'==a.type",checkbox:"'checkbox'==a.type",file:"'file'==a.type",password:"'password'==a.type",submit:"'submit'==a.type",image:"'image'==a.type",reset:"'reset'==a.type",button:'"button"==a.type||jQuery.nodeName(a,"button")',input:"/input|select|textarea|button/i.test(a.nodeName)",has:"jQuery.find(m[3],a).length",header:"/h\\d/i.test(a.nodeName)",animated:"jQuery.grep(jQuery.timers,function(fn){return a==fn.elem;}).length"}},parse:[/^(\[) *@?([\w-]+) *([!*$^~=]*) *('?"?)(.*?)\4 *\]/,/^(:)([\w-]+)\("?'?(.*?(\(.*?\))?[^(]*?)"?'?\)/,new RegExp("^([:.#]*)("+chars+"+)")],multiFilter:function(expr,elems,not){var old,cur=[];while(expr&&expr!=old){old=expr;var f=jQuery.filter(expr,elems,not);expr=f.t.replace(/^\s*,\s*/,"");cur=not?elems=f.r:jQuery.merge(cur,f.r);}
return cur;},find:function(t,context){if(typeof t!="string")
return[t];if(context&&!context.nodeType)
context=null;context=context||document;var ret=[context],done=[],last;while(t&&last!=t){var r=[];last=t;t=jQuery.trim(t);var foundToken=false;var re=quickChild;var m=re.exec(t);if(m){var nodeName=m[1].toUpperCase();for(var i=0;ret[i];i++)
for(var c=ret[i].firstChild;c;c=c.nextSibling)
if(c.nodeType==1&&(nodeName=="*"||c.nodeName.toUpperCase()==nodeName.toUpperCase()))
r.push(c);ret=r;t=t.replace(re,"");if(t.indexOf(" ")==0)continue;foundToken=true;}else{re=/^([>+~])\s*(\w*)/i;if((m=re.exec(t))!=null){r=[];var nodeName=m[2],merge={};m=m[1];for(var j=0,rl=ret.length;j<rl;j++){var n=m=="~"||m=="+"?ret[j].nextSibling:ret[j].firstChild;for(;n;n=n.nextSibling)
if(n.nodeType==1){var id=jQuery.data(n);if(m=="~"&&merge[id])break;if(!nodeName||n.nodeName.toUpperCase()==nodeName.toUpperCase()){if(m=="~")merge[id]=true;r.push(n);}
if(m=="+")break;}}
ret=r;t=jQuery.trim(t.replace(re,""));foundToken=true;}}
if(t&&!foundToken){if(!t.indexOf(",")){if(context==ret[0])ret.shift();done=jQuery.merge(done,ret);r=ret=[context];t=" "+t.substr(1,t.length);}else{var re2=quickID;var m=re2.exec(t);if(m){m=[0,m[2],m[3],m[1]];}else{re2=quickClass;m=re2.exec(t);}
m[2]=m[2].replace(/\\/g,"");var elem=ret[ret.length-1];if(m[1]=="#"&&elem&&elem.getElementById&&!jQuery.isXMLDoc(elem)){var oid=elem.getElementById(m[2]);if((jQuery.browser.msie||jQuery.browser.opera)&&oid&&typeof oid.id=="string"&&oid.id!=m[2])
oid=jQuery('[@id="'+m[2]+'"]',elem)[0];ret=r=oid&&(!m[3]||jQuery.nodeName(oid,m[3]))?[oid]:[];}else{for(var i=0;ret[i];i++){var tag=m[1]=="#"&&m[3]?m[3]:m[1]!=""||m[0]==""?"*":m[2];if(tag=="*"&&ret[i].nodeName.toLowerCase()=="object")
tag="param";r=jQuery.merge(r,ret[i].getElementsByTagName(tag));}
if(m[1]==".")
r=jQuery.classFilter(r,m[2]);if(m[1]=="#"){var tmp=[];for(var i=0;r[i];i++)
if(r[i].getAttribute("id")==m[2]){tmp=[r[i]];break;}
r=tmp;}
ret=r;}
t=t.replace(re2,"");}}
if(t){var val=jQuery.filter(t,r);ret=r=val.r;t=jQuery.trim(val.t);}}
if(t)
ret=[];if(ret&&context==ret[0])
ret.shift();done=jQuery.merge(done,ret);return done;},classFilter:function(r,m,not){m=" "+m+" ";var tmp=[];for(var i=0;r[i];i++){var pass=(" "+r[i].className+" ").indexOf(m)>=0;if(!not&&pass||not&&!pass)
tmp.push(r[i]);}
return tmp;},filter:function(t,r,not){var last;while(t&&t!=last){last=t;var p=jQuery.parse,m;for(var i=0;p[i];i++){m=p[i].exec(t);if(m){t=t.substring(m[0].length);m[2]=m[2].replace(/\\/g,"");break;}}
if(!m)
break;if(m[1]==":"&&m[2]=="not")
r=jQuery.filter(m[3],r,true).r;else if(m[1]==".")
r=jQuery.classFilter(r,m[2],not);else if(m[1]=="["){var tmp=[],type=m[3];for(var i=0,rl=r.length;i<rl;i++){var a=r[i],z=a[jQuery.props[m[2]]||m[2]];if(z==null||/href|src|selected/.test(m[2]))
z=jQuery.attr(a,m[2])||'';if((type==""&&!!z||type=="="&&z==m[5]||type=="!="&&z!=m[5]||type=="^="&&z&&!z.indexOf(m[5])||type=="$="&&z.substr(z.length-m[5].length)==m[5]||(type=="*="||type=="~=")&&z.indexOf(m[5])>=0)^not)
tmp.push(a);}
r=tmp;}else if(m[1]==":"&&m[2]=="nth-child"){var merge={},tmp=[],test=/(\d*)n\+?(\d*)/.exec(m[3]=="even"&&"2n"||m[3]=="odd"&&"2n+1"||!/\D/.test(m[3])&&"n+"+m[3]||m[3]),first=(test[1]||1)-0,last=test[2]-0;for(var i=0,rl=r.length;i<rl;i++){var node=r[i],parentNode=node.parentNode,id=jQuery.data(parentNode);if(!merge[id]){var c=1;for(var n=parentNode.firstChild;n;n=n.nextSibling)
if(n.nodeType==1)
n.nodeIndex=c++;merge[id]=true;}
var add=false;if(first==1){if(last==0||node.nodeIndex==last)
add=true;}else if((node.nodeIndex+last)%first==0)
add=true;if(add^not)
tmp.push(node);}
r=tmp;}else{var f=jQuery.expr[m[1]];if(typeof f!="string")
f=jQuery.expr[m[1]][m[2]];f=eval("false||function(a,i){return "+f+"}");r=jQuery.grep(r,f,not);}}
return{r:r,t:t};},dir:function(elem,dir){var matched=[];var cur=elem[dir];while(cur&&cur!=document){if(cur.nodeType==1)
matched.push(cur);cur=cur[dir];}
return matched;},nth:function(cur,result,dir,elem){result=result||1;var num=0;for(;cur;cur=cur[dir])
if(cur.nodeType==1&&++num==result)
break;return cur;},sibling:function(n,elem){var r=[];for(;n;n=n.nextSibling){if(n.nodeType==1&&(!elem||n!=elem))
r.push(n);}
return r;}});jQuery.event={add:function(element,type,handler,data){if(jQuery.browser.msie&&element.setInterval!=undefined)
element=window;if(!handler.guid)
handler.guid=this.guid++;if(data!=undefined){var fn=handler;handler=function(){return fn.apply(this,arguments);};handler.data=data;handler.guid=fn.guid;}
var parts=type.split(".");type=parts[0];handler.type=parts[1];var events=jQuery.data(element,"events")||jQuery.data(element,"events",{});var handle=jQuery.data(element,"handle")||jQuery.data(element,"handle",function(){var val;if(typeof jQuery=="undefined"||jQuery.event.triggered)
return val;val=jQuery.event.handle.apply(element,arguments);return val;});var handlers=events[type];if(!handlers){handlers=events[type]={};if(element.addEventListener)
element.addEventListener(type,handle,false);else
element.attachEvent("on"+type,handle);}
handlers[handler.guid]=handler;this.global[type]=true;},guid:1,global:{},remove:function(element,type,handler){var events=jQuery.data(element,"events"),ret,index;if(typeof type=="string"){var parts=type.split(".");type=parts[0];}
if(events){if(type&&type.type){handler=type.handler;type=type.type;}
if(!type){for(type in events)
this.remove(element,type);}else if(events[type]){if(handler)
delete events[type][handler.guid];else
for(handler in events[type])
if(!parts[1]||events[type][handler].type==parts[1])
delete events[type][handler];for(ret in events[type])break;if(!ret){if(element.removeEventListener)
element.removeEventListener(type,jQuery.data(element,"handle"),false);else
element.detachEvent("on"+type,jQuery.data(element,"handle"));ret=null;delete events[type];}}
for(ret in events)break;if(!ret){jQuery.removeData(element,"events");jQuery.removeData(element,"handle");}}},trigger:function(type,data,element,donative,extra){data=jQuery.makeArray(data||[]);if(!element){if(this.global[type])
jQuery("*").add([window,document]).trigger(type,data);}else{var val,ret,fn=jQuery.isFunction(element[type]||null),event=!data[0]||!data[0].preventDefault;if(event)
data.unshift(this.fix({type:type,target:element}));data[0].type=type;if(jQuery.isFunction(jQuery.data(element,"handle")))
val=jQuery.data(element,"handle").apply(element,data);if(!fn&&element["on"+type]&&element["on"+type].apply(element,data)===false)
val=false;if(event)
data.shift();if(extra&&extra.apply(element,data)===false)
val=false;if(fn&&donative!==false&&val!==false&&!(jQuery.nodeName(element,'a')&&type=="click")){this.triggered=true;element[type]();}
this.triggered=false;}
return val;},handle:function(event){var val;event=jQuery.event.fix(event||window.event||{});var parts=event.type.split(".");event.type=parts[0];var handlers=jQuery.data(this,"events")&&jQuery.data(this,"events")[event.type],args=Array.prototype.slice.call(arguments,1);args.unshift(event);for(var j in handlers){var handler=handlers[j];args[0].handler=handler;args[0].data=handler.data;if(!parts[1]||handler.type==parts[1]){var ret=handler.apply(this,args);if(val!==false)
val=ret;if(ret===false){event.preventDefault();event.stopPropagation();}}}
if(jQuery.browser.msie)
event.target=event.preventDefault=event.stopPropagation=event.handler=event.data=null;return val;},fix:function(event){var originalEvent=event;event=jQuery.extend({},originalEvent);event.preventDefault=function(){if(originalEvent.preventDefault)
originalEvent.preventDefault();originalEvent.returnValue=false;};event.stopPropagation=function(){if(originalEvent.stopPropagation)
originalEvent.stopPropagation();originalEvent.cancelBubble=true;};if(!event.target&&event.srcElement)
event.target=event.srcElement;if(jQuery.browser.safari&&event.target.nodeType==3)
event.target=originalEvent.target.parentNode;if(!event.relatedTarget&&event.fromElement)
event.relatedTarget=event.fromElement==event.target?event.toElement:event.fromElement;if(event.pageX==null&&event.clientX!=null){var doc=document.documentElement,body=document.body;event.pageX=event.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc.clientLeft||0);event.pageY=event.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc.clientLeft||0);}
if(!event.which&&(event.charCode||event.keyCode))
event.which=event.charCode||event.keyCode;if(!event.metaKey&&event.ctrlKey)
event.metaKey=event.ctrlKey;if(!event.which&&event.button)
event.which=(event.button&1?1:(event.button&2?3:(event.button&4?2:0)));return event;}};jQuery.fn.extend({bind:function(type,data,fn){return type=="unload"?this.one(type,data,fn):this.each(function(){jQuery.event.add(this,type,fn||data,fn&&data);});},one:function(type,data,fn){return this.each(function(){jQuery.event.add(this,type,function(event){jQuery(this).unbind(event);return(fn||data).apply(this,arguments);},fn&&data);});},unbind:function(type,fn){return this.each(function(){jQuery.event.remove(this,type,fn);});},trigger:function(type,data,fn){return this.each(function(){jQuery.event.trigger(type,data,this,true,fn);});},triggerHandler:function(type,data,fn){if(this[0])
return jQuery.event.trigger(type,data,this[0],false,fn);},toggle:function(){var args=arguments;return this.click(function(event){this.lastToggle=0==this.lastToggle?1:0;event.preventDefault();return args[this.lastToggle].apply(this,[event])||false;});},hover:function(fnOver,fnOut){function handleHover(event){var parent=event.relatedTarget;while(parent&&parent!=this)try{parent=parent.parentNode;}catch(error){parent=this;};if(parent==this)return false;return(event.type=="mouseover"?fnOver:fnOut).apply(this,[event]);}
return this.mouseover(handleHover).mouseout(handleHover);},ready:function(fn){bindReady();if(jQuery.isReady)
fn.apply(document,[jQuery]);else
jQuery.readyList.push(function(){return fn.apply(this,[jQuery]);});return this;}});jQuery.extend({isReady:false,readyList:[],ready:function(){if(!jQuery.isReady){jQuery.isReady=true;if(jQuery.readyList){jQuery.each(jQuery.readyList,function(){this.apply(document);});jQuery.readyList=null;}
if(jQuery.browser.mozilla||jQuery.browser.opera)
document.removeEventListener("DOMContentLoaded",jQuery.ready,false);}}});jQuery.each(("blur,focus,load,resize,scroll,unload,click,dblclick,"+"mousedown,mouseup,mousemove,mouseover,mouseout,change,select,"+"submit,keydown,keypress,keyup,error").split(","),function(i,name){jQuery.fn[name]=function(fn){return fn?this.bind(name,fn):this.trigger(name);};});var readyBound=false;function bindReady(){if(readyBound)return;readyBound=true;if(jQuery.browser.mozilla||jQuery.browser.opera)
document.addEventListener("DOMContentLoaded",jQuery.ready,false);else{function timer(){try{if(jQuery.browser.msie||document.readyState!="loaded"&&document.readyState!="complete")
document.documentElement.doScroll("left");jQuery.ready();}catch(error){setTimeout(timer,0);}}
timer();}
jQuery.event.add(window,"load",jQuery.ready);}
if(jQuery.browser.msie)
jQuery(window).bind("unload",function(){$("*").add([document,window]).unbind();});jQuery.fn.extend({load:function(url,params,callback){if(jQuery.isFunction(url))
return this.bind("load",url);var off=url.indexOf(" ");if(off>=0){var selector=url.slice(off,url.length);url=url.slice(0,off);}
callback=callback||function(){};var type="GET";if(params)
if(jQuery.isFunction(params)){callback=params;params=null;}else{params=jQuery.param(params);type="POST";}
var self=this;jQuery.ajax({url:url,type:type,data:params,complete:function(res,status){if(status=="success"||status=="notmodified")
self.html(selector?jQuery("<div/>").append(res.responseText.replace(/<script(.|\s)*?\/script>/g,"")).find(selector):res.responseText);setTimeout(function(){self.each(callback,[res.responseText,status,res]);},13);}});return this;},serialize:function(){return jQuery.param(this.serializeArray());},serializeArray:function(){return this.map(function(){return jQuery.nodeName(this,"form")?jQuery.makeArray(this.elements):this;}).filter(function(){return this.name&&!this.disabled&&(this.checked||/select|textarea/i.test(this.nodeName)||/text|hidden|password/i.test(this.type));}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:val.constructor==Array?jQuery.map(val,function(val,i){return{name:elem.name,value:val};}):{name:elem.name,value:val};}).get();}});jQuery.each("ajaxStart,ajaxStop,ajaxComplete,ajaxError,ajaxSuccess,ajaxSend".split(","),function(i,o){jQuery.fn[o]=function(f){return this.bind(o,f);};});var jsc=(new Date).getTime();jQuery.extend({get:function(url,data,callback,type){if(jQuery.isFunction(data)){callback=data;data=null;}
return jQuery.ajax({type:"GET",url:url,data:data,success:callback,dataType:type});},getScript:function(url,callback){return jQuery.get(url,null,callback,"script");},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json");},post:function(url,data,callback,type){if(jQuery.isFunction(data)){callback=data;data={};}
return jQuery.ajax({type:"POST",url:url,data:data,success:callback,dataType:type});},ajaxSetup:function(settings){jQuery.extend(jQuery.ajaxSettings,settings);},ajaxSettings:{global:true,type:"GET",timeout:0,contentType:"application/x-www-form-urlencoded",processData:true,async:true,data:null},lastModified:{},ajax:function(s){var jsonp,jsre=/=(\?|%3F)/g,status,data;s=jQuery.extend(true,s,jQuery.extend(true,{},jQuery.ajaxSettings,s));if(s.data&&s.processData&&typeof s.data!="string")
s.data=jQuery.param(s.data);if(s.dataType=="jsonp"){if(s.type.toLowerCase()=="get"){if(!s.url.match(jsre))
s.url+=(s.url.match(/\?/)?"&":"?")+(s.jsonp||"callback")+"=?";}else if(!s.data||!s.data.match(jsre))
s.data=(s.data?s.data+"&":"")+(s.jsonp||"callback")+"=?";s.dataType="json";}
if(s.dataType=="json"&&(s.data&&s.data.match(jsre)||s.url.match(jsre))){jsonp="jsonp"+jsc++;if(s.data)
s.data=s.data.replace(jsre,"="+jsonp);s.url=s.url.replace(jsre,"="+jsonp);s.dataType="script";window[jsonp]=function(tmp){data=tmp;success();complete();window[jsonp]=undefined;try{delete window[jsonp];}catch(e){}};}
if(s.dataType=="script"&&s.cache==null)
s.cache=false;if(s.cache===false&&s.type.toLowerCase()=="get")
s.url+=(s.url.match(/\?/)?"&":"?")+"_="+(new Date()).getTime();if(s.data&&s.type.toLowerCase()=="get"){s.url+=(s.url.match(/\?/)?"&":"?")+s.data;s.data=null;}
if(s.global&&!jQuery.active++)
jQuery.event.trigger("ajaxStart");if(!s.url.indexOf("http")&&s.dataType=="script"){var head=document.getElementsByTagName("head")[0];var script=document.createElement("script");script.src=s.url;if(!jsonp&&(s.success||s.complete)){var done=false;script.onload=script.onreadystatechange=function(){if(!done&&(!this.readyState||this.readyState=="loaded"||this.readyState=="complete")){done=true;success();complete();head.removeChild(script);}};}
head.appendChild(script);return;}
var requestDone=false;var xml=window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest();xml.open(s.type,s.url,s.async);if(s.data)
xml.setRequestHeader("Content-Type",s.contentType);if(s.ifModified)
xml.setRequestHeader("If-Modified-Since",jQuery.lastModified[s.url]||"Thu, 01 Jan 1970 00:00:00 GMT");xml.setRequestHeader("X-Requested-With","XMLHttpRequest");if(s.beforeSend)
s.beforeSend(xml);if(s.global)
jQuery.event.trigger("ajaxSend",[xml,s]);var onreadystatechange=function(isTimeout){if(!requestDone&&xml&&(xml.readyState==4||isTimeout=="timeout")){requestDone=true;if(ival){clearInterval(ival);ival=null;}
status=isTimeout=="timeout"&&"timeout"||!jQuery.httpSuccess(xml)&&"error"||s.ifModified&&jQuery.httpNotModified(xml,s.url)&&"notmodified"||"success";if(status=="success"){try{data=jQuery.httpData(xml,s.dataType);}catch(e){status="parsererror";}}
if(status=="success"){var modRes;try{modRes=xml.getResponseHeader("Last-Modified");}catch(e){}
if(s.ifModified&&modRes)
jQuery.lastModified[s.url]=modRes;if(!jsonp)
success();}else
jQuery.handleError(s,xml,status);complete();if(s.async)
xml=null;}};if(s.async){var ival=setInterval(onreadystatechange,13);if(s.timeout>0)
setTimeout(function(){if(xml){xml.abort();if(!requestDone)
onreadystatechange("timeout");}},s.timeout);}
try{xml.send(s.data);}catch(e){jQuery.handleError(s,xml,null,e);}
if(!s.async)
onreadystatechange();return xml;function success(){if(s.success)
s.success(data,status);if(s.global)
jQuery.event.trigger("ajaxSuccess",[xml,s]);}
function complete(){if(s.complete)
s.complete(xml,status);if(s.global)
jQuery.event.trigger("ajaxComplete",[xml,s]);if(s.global&&!--jQuery.active)
jQuery.event.trigger("ajaxStop");}},handleError:function(s,xml,status,e){if(s.error)s.error(xml,status,e);if(s.global)
jQuery.event.trigger("ajaxError",[xml,s,e]);},active:0,httpSuccess:function(r){try{return!r.status&&location.protocol=="file:"||(r.status>=200&&r.status<300)||r.status==304||jQuery.browser.safari&&r.status==undefined;}catch(e){}
return false;},httpNotModified:function(xml,url){try{var xmlRes=xml.getResponseHeader("Last-Modified");return xml.status==304||xmlRes==jQuery.lastModified[url]||jQuery.browser.safari&&xml.status==undefined;}catch(e){}
return false;},httpData:function(r,type){var ct=r.getResponseHeader("content-type");var xml=type=="xml"||!type&&ct&&ct.indexOf("xml")>=0;var data=xml?r.responseXML:r.responseText;if(xml&&data.documentElement.tagName=="parsererror")
throw"parsererror";if(type=="script")
jQuery.globalEval(data);if(type=="json")
data=eval("("+data+")");return data;},param:function(a){var s=[];if(a.constructor==Array||a.jquery)
jQuery.each(a,function(){s.push(encodeURIComponent(this.name)+"="+encodeURIComponent(this.value));});else
for(var j in a)
if(a[j]&&a[j].constructor==Array)
jQuery.each(a[j],function(){s.push(encodeURIComponent(j)+"="+encodeURIComponent(this));});else
s.push(encodeURIComponent(j)+"="+encodeURIComponent(a[j]));return s.join("&").replace(/%20/g,"+");}});jQuery.fn.extend({show:function(speed,callback){return speed?this.animate({height:"show",width:"show",opacity:"show"},speed,callback):this.filter(":hidden").each(function(){this.style.display=this.oldblock?this.oldblock:"";if(jQuery.css(this,"display")=="none")
this.style.display="block";}).end();},hide:function(speed,callback){return speed?this.animate({height:"hide",width:"hide",opacity:"hide"},speed,callback):this.filter(":visible").each(function(){this.oldblock=this.oldblock||jQuery.css(this,"display");if(this.oldblock=="none")
this.oldblock="block";this.style.display="none";}).end();},_toggle:jQuery.fn.toggle,toggle:function(fn,fn2){return jQuery.isFunction(fn)&&jQuery.isFunction(fn2)?this._toggle(fn,fn2):fn?this.animate({height:"toggle",width:"toggle",opacity:"toggle"},fn,fn2):this.each(function(){jQuery(this)[jQuery(this).is(":hidden")?"show":"hide"]();});},slideDown:function(speed,callback){return this.animate({height:"show"},speed,callback);},slideUp:function(speed,callback){return this.animate({height:"hide"},speed,callback);},slideToggle:function(speed,callback){return this.animate({height:"toggle"},speed,callback);},fadeIn:function(speed,callback){return this.animate({opacity:"show"},speed,callback);},fadeOut:function(speed,callback){return this.animate({opacity:"hide"},speed,callback);},fadeTo:function(speed,to,callback){return this.animate({opacity:to},speed,callback);},animate:function(prop,speed,easing,callback){var opt=jQuery.speed(speed,easing,callback);return this[opt.queue===false?"each":"queue"](function(){opt=jQuery.extend({},opt);var hidden=jQuery(this).is(":hidden"),self=this;for(var p in prop){if(prop[p]=="hide"&&hidden||prop[p]=="show"&&!hidden)
return jQuery.isFunction(opt.complete)&&opt.complete.apply(this);if(p=="height"||p=="width"){opt.display=jQuery.css(this,"display");opt.overflow=this.style.overflow;}}
if(opt.overflow!=null)
this.style.overflow="hidden";opt.curAnim=jQuery.extend({},prop);jQuery.each(prop,function(name,val){var e=new jQuery.fx(self,opt,name);if(/toggle|show|hide/.test(val))
e[val=="toggle"?hidden?"show":"hide":val](prop);else{var parts=val.toString().match(/^([+-]=)?([\d+-.]+)(.*)$/),start=e.cur(true)||0;if(parts){var end=parseFloat(parts[2]),unit=parts[3]||"px";if(unit!="px"){self.style[name]=(end||1)+unit;start=((end||1)/e.cur(true))*start;self.style[name]=start+unit;}
if(parts[1])
end=((parts[1]=="-="?-1:1)*end)+start;e.custom(start,end,unit);}else
e.custom(start,val,"");}});return true;});},queue:function(type,fn){if(jQuery.isFunction(type)){fn=type;type="fx";}
if(!type||(typeof type=="string"&&!fn))
return queue(this[0],type);return this.each(function(){if(fn.constructor==Array)
queue(this,type,fn);else{queue(this,type).push(fn);if(queue(this,type).length==1)
fn.apply(this);}});},stop:function(){var timers=jQuery.timers;return this.each(function(){for(var i=0;i<timers.length;i++)
if(timers[i].elem==this)
timers.splice(i--,1);}).dequeue();}});var queue=function(elem,type,array){if(!elem)
return;var q=jQuery.data(elem,type+"queue");if(!q||array)
q=jQuery.data(elem,type+"queue",array?jQuery.makeArray(array):[]);return q;};jQuery.fn.dequeue=function(type){type=type||"fx";return this.each(function(){var q=queue(this,type);q.shift();if(q.length)
q[0].apply(this);});};jQuery.extend({speed:function(speed,easing,fn){var opt=speed&&speed.constructor==Object?speed:{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&easing.constructor!=Function&&easing};opt.duration=(opt.duration&&opt.duration.constructor==Number?opt.duration:{slow:600,fast:200}[opt.duration])||400;opt.old=opt.complete;opt.complete=function(){jQuery(this).dequeue();if(jQuery.isFunction(opt.old))
opt.old.apply(this);};return opt;},easing:{linear:function(p,n,firstNum,diff){return firstNum+diff*p;},swing:function(p,n,firstNum,diff){return((-Math.cos(p*Math.PI)/2)+0.5)*diff+firstNum;}},timers:[],fx:function(elem,options,prop){this.options=options;this.elem=elem;this.prop=prop;if(!options.orig)
options.orig={};}});jQuery.fx.prototype={update:function(){if(this.options.step)
this.options.step.apply(this.elem,[this.now,this]);(jQuery.fx.step[this.prop]||jQuery.fx.step._default)(this);if(this.prop=="height"||this.prop=="width")
this.elem.style.display="block";},cur:function(force){if(this.elem[this.prop]!=null&&this.elem.style[this.prop]==null)
return this.elem[this.prop];var r=parseFloat(jQuery.curCSS(this.elem,this.prop,force));return r&&r>-10000?r:parseFloat(jQuery.css(this.elem,this.prop))||0;},custom:function(from,to,unit){this.startTime=(new Date()).getTime();this.start=from;this.end=to;this.unit=unit||this.unit||"px";this.now=this.start;this.pos=this.state=0;this.update();var self=this;function t(){return self.step();}
t.elem=this.elem;jQuery.timers.push(t);if(jQuery.timers.length==1){var timer=setInterval(function(){var timers=jQuery.timers;for(var i=0;i<timers.length;i++)
if(!timers[i]())
timers.splice(i--,1);if(!timers.length)
clearInterval(timer);},13);}},show:function(){this.options.orig[this.prop]=jQuery.attr(this.elem.style,this.prop);this.options.show=true;this.custom(0,this.cur());if(this.prop=="width"||this.prop=="height")
this.elem.style[this.prop]="1px";jQuery(this.elem).show();},hide:function(){this.options.orig[this.prop]=jQuery.attr(this.elem.style,this.prop);this.options.hide=true;this.custom(this.cur(),0);},step:function(){var t=(new Date()).getTime();if(t>this.options.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();this.options.curAnim[this.prop]=true;var done=true;for(var i in this.options.curAnim)
if(this.options.curAnim[i]!==true)
done=false;if(done){if(this.options.display!=null){this.elem.style.overflow=this.options.overflow;this.elem.style.display=this.options.display;if(jQuery.css(this.elem,"display")=="none")
this.elem.style.display="block";}
if(this.options.hide)
this.elem.style.display="none";if(this.options.hide||this.options.show)
for(var p in this.options.curAnim)
jQuery.attr(this.elem.style,p,this.options.orig[p]);}
if(done&&jQuery.isFunction(this.options.complete))
this.options.complete.apply(this.elem);return false;}else{var n=t-this.startTime;this.state=n/this.options.duration;this.pos=jQuery.easing[this.options.easing||(jQuery.easing.swing?"swing":"linear")](this.state,n,0,1,this.options.duration);this.now=this.start+((this.end-this.start)*this.pos);this.update();}
return true;}};jQuery.fx.step={scrollLeft:function(fx){fx.elem.scrollLeft=fx.now;},scrollTop:function(fx){fx.elem.scrollTop=fx.now;},opacity:function(fx){jQuery.attr(fx.elem.style,"opacity",fx.now);},_default:function(fx){fx.elem.style[fx.prop]=fx.now+fx.unit;}};jQuery.fn.offset=function(){var left=0,top=0,elem=this[0],results;if(elem)with(jQuery.browser){var parent=elem.parentNode,offsetChild=elem,offsetParent=elem.offsetParent,doc=elem.ownerDocument,safari2=safari&&parseInt(version)<522,fixed=jQuery.css(elem,"position")=="fixed";if(elem.getBoundingClientRect){var box=elem.getBoundingClientRect();add(box.left+Math.max(doc.documentElement.scrollLeft,doc.body.scrollLeft),box.top+Math.max(doc.documentElement.scrollTop,doc.body.scrollTop));if(msie){var border=jQuery("html").css("borderWidth");border=(border=="medium"||jQuery.boxModel&&parseInt(version)>=7)&&2||border;add(-border,-border);}}else{add(elem.offsetLeft,elem.offsetTop);while(offsetParent){add(offsetParent.offsetLeft,offsetParent.offsetTop);if(mozilla&&!/^t(able|d|h)$/i.test(offsetParent.tagName)||safari&&!safari2)
border(offsetParent);if(!fixed&&jQuery.css(offsetParent,"position")=="fixed")
fixed=true;offsetChild=/^body$/i.test(offsetParent.tagName)?offsetChild:offsetParent;offsetParent=offsetParent.offsetParent;}
while(parent.tagName&&!/^body|html$/i.test(parent.tagName)){if(!/^inline|table-row.*$/i.test(jQuery.css(parent,"display")))
add(-parent.scrollLeft,-parent.scrollTop);if(mozilla&&jQuery.css(parent,"overflow")!="visible")
border(parent);parent=parent.parentNode;}
if((safari2&&(fixed||jQuery.css(offsetChild,"position")=="absolute"))||(mozilla&&jQuery.css(offsetChild,"position")!="absoltue"))
add(-doc.body.offsetLeft,-doc.body.offsetTop);if(fixed)
add(Math.max(doc.documentElement.scrollLeft,doc.body.scrollLeft),Math.max(doc.documentElement.scrollTop,doc.body.scrollTop));}
results={top:top,left:left};}
return results;function border(elem){add(jQuery.css(elem,"borderLeftWidth"),jQuery.css(elem,"borderTopWidth"));}
function add(l,t){left+=parseInt(l)||0;top+=parseInt(t)||0;}};})();(function($){$.ifixpng=function(customPixel){$.ifixpng.pixel=customPixel;};$.ifixpng.getPixel=function(){return $.ifixpng.pixel||'images/pixel.gif';};var hack={ltie7:$.browser.msie&&/MSIE\s(5\.5|6\.)/.test(navigator.userAgent),filter:function(src){return"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true,sizingMethod=crop,src='"+src+"')";}};$.fn.ifixpng=hack.ltie7?function(){return this.each(function(){var $$=$(this);var base=$('base').attr('href');if($$.is('img')||$$.is('input')){if($$.attr('src').match(/.*\.png([?].*)?$/i)){var source=(base&&$$.attr('src').substring(0,1)!='/')?base+$$.attr('src'):$$.attr('src');$$.css({filter:hack.filter(source),width:$$.width(),height:$$.height()}).attr({src:$.ifixpng.getPixel()}).positionFix();}}else{var image=$$.css('backgroundImage');if(image.match(/^url\(["']?(.*\.png([?].*)?)["']?\)$/i)){image=RegExp.$1;$$.css({backgroundImage:'none',filter:hack.filter(image)}).positionFix();}}});}:function(){return this;};$.fn.iunfixpng=hack.ltie7?function(){return this.each(function(){var $$=$(this);var src=$$.css('filter');if(src.match(/src=["']?(.*\.png([?].*)?)["']?/i)){src=RegExp.$1;if($$.is('img')||$$.is('input')){$$.attr({src:src}).css({filter:''});}else{$$.css({filter:'',background:'url('+src+')'});}}});}:function(){return this;};$.fn.positionFix=function(){return this.each(function(){var $$=$(this);var position=$$.css('position');if(position!='absolute'&&position!='relative'){$$.css({position:'relative'});}});};})(jQuery);(function($){var menu,shadow,trigger,content,hash,currentTarget;var defaults={menuStyle:{listStyle:'none',padding:'1px',margin:'0px',backgroundColor:'#fff',border:'1px solid #999',width:'100px'},itemStyle:{margin:'0px',color:'#000',display:'block',cursor:'default',padding:'3px',border:'1px solid #fff',backgroundColor:'transparent'},itemHoverStyle:{border:'1px solid #0a246a',backgroundColor:'#b6bdd2'},eventPosX:'pageX',eventPosY:'pageY',shadow:true,onContextMenu:null,onShowMenu:null};$.fn.contextMenu=function(id,options){if(!menu){menu=$('<div id="jqContextMenu"></div>').hide().css({position:'absolute',zIndex:'500'}).appendTo('body').bind('click',function(e){e.stopPropagation();});}
if(!shadow){shadow=$('<div></div>').css({backgroundColor:'#000',position:'absolute',opacity:0.2,zIndex:499}).appendTo('body').hide();}
hash=hash||[];hash.push({id:id,menuStyle:$.extend({},defaults.menuStyle,options.menuStyle||{}),itemStyle:$.extend({},defaults.itemStyle,options.itemStyle||{}),itemHoverStyle:$.extend({},defaults.itemHoverStyle,options.itemHoverStyle||{}),bindings:options.bindings||{},shadow:options.shadow||options.shadow===false?options.shadow:defaults.shadow,onContextMenu:options.onContextMenu||defaults.onContextMenu,onShowMenu:options.onShowMenu||defaults.onShowMenu,eventPosX:options.eventPosX||defaults.eventPosX,eventPosY:options.eventPosY||defaults.eventPosY});var index=hash.length-1;$(this).bind('contextmenu',function(e){var bShowContext=(!!hash[index].onContextMenu)?hash[index].onContextMenu(e):true;if(bShowContext){display(index,this,e,options);return false;}
return true;});return this;};function display(index,trigger,e,options){var cur=hash[index];content=$('#'+cur.id).find('ul:first').clone(true);content.css(cur.menuStyle).find('li').css(cur.itemStyle).hover(function(){$(this).css(cur.itemHoverStyle);},function(){$(this).css(cur.itemStyle);}).find('img').css({verticalAlign:'middle',paddingRight:'2px'});menu.html(content);if(!!cur.onShowMenu)menu=cur.onShowMenu(e,menu);$.each(cur.bindings,function(id,func){$('#'+id,menu).bind('click',function(e){hide();func(trigger,currentTarget);});});menu.css({'left':e[cur.eventPosX],'top':e[cur.eventPosY]}).show();if(cur.shadow)shadow.css({width:menu.width(),height:menu.height(),left:e.pageX+2,top:e.pageY+2}).show();$(document).one('click',hide);}
function hide(){menu.hide();shadow.hide();}
$.contextMenu={defaults:function(userDefaults){$.each(userDefaults,function(i,val){if(typeof val=='object'&&defaults[i]){$.extend(defaults[i],val);}
else defaults[i]=val;});}};})(jQuery);$.defineTag=function(tag){$[tag.toUpperCase()]=function(){return $._createNode(tag,arguments);}};(function(){var tags=['a','br','button','canvas','div','fieldset','form','h1','h2','h3','hr','img','input','label','legend','li','ol','optgroup','option','p','pre','select','span','strong','table','tbody','td','textarea','tfoot','th','thead','tr','tt','ul'];for(var i=tags.length-1;i>=0;i--){$.defineTag(tags[i]);}})();$.NBSP='\u00a0';$._createNode=function(tag,args){var fix={'class':'className','Class':'className'};var e;try{var attrs=args[0]||{};e=document.createElement(tag);for(var attr in attrs){var a=fix[attr]||attr;e[a]=attrs[attr];}
for(var i=1;i<args.length;i++){var arg=args[i];if(arg==null)continue;if(arg.constructor!=Array)append(arg);else for(var j=0;j<arg.length;j++)
append(arg[j]);}}
catch(ex){alert('Cannot create <'+tag+'> element:\n'+
args.toSource()+'\n'+args);e=null;}
function append(arg){if(arg==null)return;var c=arg.constructor;switch(typeof arg){case'number':arg=''+arg;case'string':arg=document.createTextNode(arg);}
e.appendChild(arg);}
return e;};BrowserDetect=function(){};BrowserDetect.prototype={init:function(){browser.browser=browser.searchString(browser.dataBrowser)||"An unknown browser";browser.version=browser.searchVersion(navigator.userAgent)||browser.searchVersion(navigator.appVersion)||"an unknown version";browser.OS=browser.searchString(browser.dataOS)||"an unknown OS";},searchString:function(data){for(var i=0;i<data.length;i++){var dataString=data[i].string;var dataProp=data[i].prop;browser.versionSearchString=data[i].versionSearch||data[i].identity;if(dataString){if(dataString.indexOf(data[i].subString)!=-1)
return data[i].identity;}
else if(dataProp)
return data[i].identity;}},searchVersion:function(dataString){var index=dataString.indexOf(browser.versionSearchString);if(index==-1)return;return parseFloat(dataString.substring(index+browser.versionSearchString.length+1));},dataBrowser:[{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};Notebook={};Notebook.__init__={};Notebook.initialize=function(){browser=new BrowserDetect();browser.init();$.ifixpng('/static/img/pixel.gif');$.extend($('#notebook')[0],{setFocus:function(){this.firstChild.setFocus();},focusFromBelow:function(){this.lastChild.focusFromBelow();}});var topnode=Notebook.dom.topspawner();$.extend(topnode,{focusUp:function(){},setFocus:function(){this.firstChild.focus();},beBlured:function(){},focusDown:function(){if($('#main > :first-child')[0]){$('#main > :first-child')[0].focusFromAbove();}}});var mainnode=Notebook.dom.mainDIV();$.extend(mainnode,{getCellLevel:function(){return 0;},getParentBranch:function(){return $('#main')[0];},contentNode:function(){return $('#main')[0];},focusPreviousSibling:function(){this.previousSibling.setFocus();},focusUp:function(){this.focusPreviousSibling();},focusFromBelow:function(){this.lastChild.focusFromBelow();}});mainnode.cell=false;var botpad=Notebook.dom.botPad();$.extend(botpad,{focusFromAbove:function(){if(this.previousSibling){this.previousSibling.focusFromBelow();}else{this.parentNode.focusUp();}},focusFromBelow:function(){if(this.previousSibling){this.previousSibling.focusFromBelow();}else{this.parentNode.focusUp();}}});$(mainnode).append(botpad);$('#notebook').append(topnode,mainnode);Notebook.cellid=0;topnode.setFocus();Util.nbTitle(document.title);$('#titlecontainer').bind('click',Util.startChangeTitle);var contextmenu=Notebook.DOM.contextMenu();$('#foot').after(contextmenu);};Notebook.SelectionManager=function(){this.selections=[];};Notebook.SelectionManager.prototype={deselectAll:function(){for(var s in this.selections){$('#'+this.selections[s])[0].setBracketUnSelected();}
this.selections=[];},select:function(id){this.deselectAll();$('#'+id)[0].setBracketSelected();this.selections.push(id);$('#auxinput').focus();},selectMore:function(id){$('#'+id)[0].setBracketSelected();this.selections.push(id);},modifySelectionStyle:function(newstyle){if(this.selections.length==1){Notebook.TreeBranch.changeCell(newstyle,$('#'+this.selections[0])[0]);this.deselectAll();}},deleteSelections:function(){for(var s in this.selections){var selection=this.selections[s];Notebook.TreeBranch.deleteCellNode($('#'+selection)[0]);}
this.selections=[];},isSelected:function(id){var index=$.inArray(id,this.selections);if(index==-1){return false;}
return true;}};Notebook.__init__.Notebook=function(){Notebook.initialize();};__notebook_component_inits__=function(){Notebook.Indicator.loading();Notebook.__init__.Notebook();Notebook.__init__.Delegator();Notebook.__init__.Completer();Notebook.__init__.Async();Util.init();};$(document).ready(__notebook_component_inits__);Notebook.Indicator={};Notebook.Indicator.beginMsg=function(text){$("#status_message").text(text);$("#status").css("top","-2px").show();setTimeout(Notebook.Indicator.endMsg,3000);};Notebook.Indicator.endMsg=function(text){$("#status").animate({"top":"20"},500);};Notebook.Indicator.endError=function(text){$('.curmsg').text(text).css('background-color','red').fadeOut(10000,function(){$(this).remove()});};Notebook.Indicator.loading=function(){Notebook.Indicator.beginMsg('Loading...');};Notebook.Indicator.loaded=function(){Notebook.Indicator.endMsg('Notebook Loaded.');};Notebook.Indicator.save=function(){Notebook.Indicator.beginMsg('Saving...');};Notebook.Indicator.saved=function(){Notebook.Indicator.endMsg('Saved.');};Notebook.Indicator.saveError=function(){Notebook.Indicator.endError('Error Saving!');};Notebook.Cell=function(){this.conrad='uno';};Notebook.Cell.prototype.initCommon=function(){this.cell=true;this.evaluating=0;this.completing=false;this.saved=false;};Notebook.Cell.prototype.getProps=function(){var props={cellstyle:this.cellstyle,cellevel:this.cellevel,open:this.open}
return props;};Notebook.Cell.prototype.setStyle=function(cellstyle){this.initCommon();this.cellstyle=cellstyle;this.open=true;this.oldcontent='';this.spawnerNode().enabled=false;switch(cellstyle){case'title':this.celltype='input';this.cellevel=1;this.evaluatable=false;this.editable=true;this.className='cell title';break;case'subtitle':this.celltype='input';this.cellevel=2;this.evaluatable=false;this.editable=true;this.className='cell subtitle';break;case'section':this.celltype='input';this.cellevel=3;this.evaluatable=false;this.editable=true;this.className='cell section';break;case'subsection':this.celltype='input';this.cellevel=4;this.evaluatable=false;this.editable=true;this.className='cell subsection';break;case'input':this.celltype='input';this.cellevel=10;this.evaluatable=true;this.editable=true;this.className='cell input';break;case'outputtext':this.celltype='output';this.cellevel=11;this.evaluatable=false;this.editable=false;this.className='cell output';break;case'outputimage':this.celltype='output';this.cellevel=11;this.evaluatable=false;this.editable=false;this.className='cell output';break;case'text':this.celltype='input';this.cellevel=15;this.evaluatable=false;this.editable=true;this.className='cell text';break;case'group':this.celltype='group';this.cellevel=-1;this.evaluatable=false;this.editable=false;this.className='cell group';break;case'text':this.celltype='text';this.cellevel=20;this.evaluatable=false;this.editable=true;this.className='cell text';this.canbehead=false;break;}};Notebook.Cell.prototype.setAsInput=function(){this.setStyle('input');};Notebook.Cell.prototype.setAsOutput=function(){this.setStyle('output');};Notebook.Cell.prototype.setAsGroup=function(){this.setStyle('group');$(this.spawnerNode()).hide();};Notebook.Cell.prototype.setType=function(){switch(this.celltype){case'input':$(this.contentNode()).append(Notebook.dom._textarea());this.textareaNode().cellid=this.id;this.textareaNode().eventtype='input';break;case'output':switch(this.cellstyle){case'outputtext':$(this.contentNode()).append(Notebook.dom._textoutput());this.textareaNode().readOnly=true;this.textareaNode().cellid=this.id;break;case'outputimage':$(this.contentNode()).append(Notebook.dom._imageoutput());break;}
break;}};Notebook.Cell.prototype.resetStyle=function(newstyle){var enabled=this.spawnerNode().enabled;this.setStyle(newstyle);this.spawnerNode().enabled=enabled;};Notebook.Cell.prototype.parentCell=function(){if(this.parentNode.id=='main'){return this.parentNode;}
return this.parentNode.parentNode;};Notebook.Cell.prototype.getParentBranch=function(){if(this.parentNode.id=='main'){return this.parentNode;}
return this.parentNode.parentNode;};Notebook.Cell.prototype.childCells=function(ids){var getCellIds=function(node){try{var nodeType=node.type();}
catch(ex){var nodeType=false;}
if(nodeType!='creator'){ids.push(node.id);}
if(nodeType=='group'){ids=node.childCells(ids);}
if(node.nextSibling){getCellIds(node.nextSibling);}};nodeWalk(this.contentNode().firstChild,getCellIds);return ids;};Notebook.Cell.prototype.getCellLevel=function(){if(this.celltype=='group'){return this.contentNode().firstChild.getCellLevel();}else{return this.cellevel;}};Notebook.Cell.prototype.previousCell=function(){var prev=this.previousSibling;if(prev){if(prev.cell){return prev;}else{return null;}}
return prev;};Notebook.Cell.prototype.prevVisibleCell=function(){var prev=$(this).prev(':visible')[0];if(prev){if(prev.cell){return prev;}else{return null;}}
prev=null;return prev;};Notebook.Cell.prototype.nextCell=function(){var next=this.nextSibling;if(next){if(next.cell){return next;}else{return null;}}
next=null;return next;};Notebook.Cell.prototype.nextVisibleCell=function(){var next=$(this).next(':visible')[0];if(next){if(next.cell){return next;}else{return null;}}
return next;};Notebook.Cell.prototype.appendChildCells=function(node){$(this.contentNode()).append(node);};Notebook.Cell.prototype.prependChildCells=function(node){$(this.contentNode()).prepend(node);};Notebook.Cell.prototype.isHead=function(){var branchheadid=this.getParentBranch().contentNode().firstChild.id;var notebookbranchQ=this.getParentBranch().id;if(branchheadid==this.id&&notebookbranchQ!='main'){return true;}
return false;};Notebook.Cell.prototype.isGroup=function(){if(this.celltype=='group'){return true;}
return false;};Notebook.Cell.prototype.setFocus=function(){switch(this.celltype){case'input':this.textareaNode().focus();break;case'group':this.contentNode().firstChild.setFocus();break;case'output':this.textareaNode().focus();break;default:return;}
$('#auxdisplay').html(this.id);};Notebook.Cell.prototype.focusLastInGroup=function(){this.contentNode().lastChild.focusFromBelow();$(this.contentNode()).children(':visible:last')[0].focusFromBelow();};Notebook.Cell.prototype.beBlured=function(){this.textareaNode().blur();return;};Notebook.Cell.prototype.focusPreviousCell=function(){var prev=this.prevVisibleCell();if(prev){prev.focusFromBelow();}else{this.parentCell().focusUp();}};Notebook.Cell.prototype.focusUp=function(){if(this.inputUpTest()){this.focusPreviousCell();}};Notebook.Cell.prototype.focusFromBelow=function(){if(this.isGroup()){this.focusLastInGroup();}else if(this.spawnerNode().enabled){this.focusSpawner();return;}else{this.setFocus();return;}};Notebook.Cell.prototype.focusNextCell=function(){var next=this.nextVisibleCell();if(next){this.beBlured();next.focusFromAbove();}else if(this.parentCell().cell){this.parentCell().focusNextCell();}else{this.focusFromBelow();}};Notebook.Cell.prototype.focusDown=function(){if(this.inputDownTest()){if(this.spawnerNode().enabled){this.beBlured();this.spawnerNode().setFocus();return;}else{this.focusNextCell();}}};Notebook.Cell.prototype.focusFromAbove=function(){this.setFocus();};Notebook.Cell.prototype.inputUpTest=function(){if(this.celltype=='input'){var s=this.getSelection();var before=this.content().substr(0,s.start);var i=before.indexOf('\n');if(i==-1||before==''){return true;}else{return false;}}else{return true;}};Notebook.Cell.prototype.inputDownTest=function(){if(this.celltype=='input'){var s=this.getSelection();var after=this.content().substr(s.end);var i=after.indexOf('\n');if(i==-1||after==''){return true;}else{return false;}}else{return true;}};Notebook.Cell.prototype.contentChanged=function(){this.clearNumberLabel();this.saved=false;};Notebook.Cell.prototype.closeGroup=function(){if(this.celltype=='group'&&this.open){$(this.contentNode().firstChild).nextAll().hide()
this.open=false;}};Notebook.Cell.prototype.openGroup=function(){if(this.celltype=='group'&&!this.open){$(this.contentNode().firstChild).nextAll().show()
this.open=true;}};Notebook.Cell.prototype.toggleOpen=function(){if(this.celltype=='group'){this.open?this.closeGroup():this.openGroup();}};Notebook.Cell.prototype.labelNode=function(){return $(this).children('.label')[0];};Notebook.Cell.prototype.contentNode=function(){return $(this).children('.contents')[0];};Notebook.Cell.prototype.stemNode=function(){return this.childNodes[2];};Notebook.Cell.prototype.spawnerNode=function(){return $(this).children('.spawner')[0];};Notebook.Cell.prototype.tabLabel=function(){return this.labelNode().childNodes[1];};Notebook.Cell.prototype.numberLabel=function(count){this.labelNode().childNodes[0].innerHTML=count;};Notebook.Cell.prototype.clearNumberLabel=function(){this.numberLabel('');};Notebook.Cell.prototype.content=function(newcontent){if(!newcontent){if(this.celltype=='input'){return this.contentNode().childNodes[0].value;}
if(this.celltype=='output'){switch(this.cellstyle){case'outputtext':return this.contentNode().childNodes[0].value;case'outputimage':return $(this.contentNode()).find('img.outputimage')[0].src;}}
if(this.celltype=='group'){return this.contentNode().childNodes;}}else{if(this.celltype=='input'){this.contentNode().childNodes[0].value=newcontent;this.oldcontent=newcontent;}
if(this.celltype=='output'){switch(this.cellstyle){case'outputtext':var contentsplit=newcontent.split('\n');var spancontent=$.map(contentsplit,function(n,i){return $.SPAN(null,n);});this.contentNode().childNodes[0].value=newcontent;break;case'outputimage':$(this.contentNode()).find('img.outputimage')[0].src=newcontent;break;}}
if(this.celltype=='iogroup'){$(this.contentNode()).children().replaceWith(newcontent);}
if(this.celltype=='group'){$(this.contentNode()).children().replaceWith(newcontent);}}};Notebook.Cell.prototype.focusContent=function(){this.contentNode().firstChild.focus();};Notebook.Cell.prototype.textareaNode=function(){return this.contentNode().childNodes[0];};Notebook.Cell.prototype.adjustTextarea=function(){if(this.celltype=='input'){var rows=this.content().split('\n').length;this.textareaNode().rows=rows;var h=$(this.textareaNode()).height();return true;}else if(this.cellstyle=='outputtext'){var rows=this.content().split('\n').length;this.textareaNode().rows=rows;var tawidth=$(this.textareaNode()).width();var breaks=this.content().split('\n');var spaces=this.content().split(' ');var longestbreak=breaks.sort(function(a,b){return a.length-b.length;}).pop().length;var fontsize=13;return;}else if(this.cellstyle=='outputimage'){var h=$(this.contentNode()).height();$(this).height(h);return;}};Notebook.Cell.prototype.checkForChange=function(){var oc=this.oldcontent;var cc=this.content();if(oc!=cc){this.contentChanged();this.oldcontent=cc;this.saved=false;}};Notebook.Cell.prototype.pageTextContent=function(){};Notebook.Cell.prototype.getSelection=function(){var s=$(this.textareaNode()).getSelection();return s;};Notebook.Cell.prototype.contentInsert=function(newcontent,cursor){var newcursor=newcontent.length+cursor;var curcontent=this.content();var finalcontent=curcontent.substr(0,cursor)+newcontent+curcontent.substr(cursor);this.content(finalcontent);if(this.contentNode().firstChild.setSelectionRange){this.contentNode().firstChild.setSelectionRange(newcursor,newcursor);}else if(this.contentNode().firstChild.createTextRange){var range=this.contentNode().firstChild.createTextRange();range.moveEnd('character',newcursor-finalcontent.length);range.collapse(false);range.select();}};Notebook.Cell.prototype.bracketNode=function(){return $(this).children('.bracketng')[0];};Notebook.Cell.prototype.focusBracket=function(){this.bracketNode().focus();};Notebook.Cell.prototype.highlightBracket=function(){$(this.bracketNode()).css('background-color','yellow');};Notebook.Cell.prototype.unhighlightBracket=function(){$(this.bracketNode()).css('background-color','white');};Notebook.Cell.prototype.setBracketSelected=function(){$(this.bracketNode()).css('outline','1px solid black');this.bracketNode().focus();};Notebook.Cell.prototype.setBracketUnSelected=function(){$(this.bracketNode()).css('outline','1px solid white');};Notebook.Cell.prototype.focusSpawner=function(){this.spawnerNode().setFocus();};Notebook.Cell.prototype.blurSpawner=function(){this.spawnerNode().beBlured();};Notebook.Cell.prototype.evaluate=function(){if(this.evaluatable){this.evaluating=2;this.highlightBracket()
Notebook.Async.evalCell(this.id,this.content());}};Notebook.Cell.prototype.evalResult=function(){this.evaluating=0;this.unhighlightBracket();};Notebook.Cell.prototype.deleteCells=function(){var ids=[this.id];ids=this.childCells(ids);var d=notebook.deleteCells(this.id,ids);return d;};Notebook.Cell.prototype.deleteCallback=function(meid,result){notebook.deleteCellNode($('#'+meid));notebook.save();};Notebook.Cell.prototype.deleteErr=function(result){};Notebook.Cell.prototype.tab=function(){var mode=this.tabCompletion();if(mode){return mode;}
this.contentInsert('    ',this.selectionStart);this.completing=false;this.setCompletingLabel('off');return'normal';};Notebook.Cell.prototype.tabCompletion=function(){var s=this.getSelection();this.selectionStart=s.start;var tomatch=this.content().substr(0,this.selectionStart);var mode=Notebook.Completer.test(this.id,tomatch);return mode;};Notebook.Cell.prototype.completionExit=function(){if(this.completing){this.completing=false;Notebook.Completer.completionExit();}};Notebook.Cell.prototype.setCompletingLabel=function(mode){switch(mode){case'tab':$(this.tabLabel()).css('background-color','blue');break;case'name':$(this.tabLabel()).css('background-color','yellow');break;case'attribute':$(this.tabLabel()).css('background-color','orange');break;case'off':$(this.tabLabel()).css('background-color','white');break;}};BASE_URL='/asyncnotebook/'+document.location.pathname.split('/')[2]+'/';Notebook.Async=function(){};Notebook.Async.initialize=function(){var url=BASE_URL+'nbobject';var success=function(res){Notebook.Load.takeCellsData(res);}
$.getJSON(url,success);Notebook.Async.startEngine();Notebook.Indicator.endMsg();};Notebook.Async.startEngine=function(){var path=BASE_URL+'start';$.ajax({url:path,type:'GET',dataType:'json',success:function(result){},error:function(result){}});};Notebook.Async.signalKernel=function(action){var self=Notebook.Async;var path=BASE_URL+'kernel';var data={'action':action};$.ajax({url:path,type:'POST',data:data,dataType:'json',success:self.signalSuccess,error:self.signalError});};Notebook.Async.signalSuccess=function(result){};Notebook.Async.signalError=function(result){};Notebook.Async.evalCell=function(cellid,input){var self=Notebook.Async;var path=BASE_URL+'eval';if(input=='?'){var input='introspect?';}
var data={'cellid':cellid,'input':input};$.ajax({url:path,type:'POST',data:data,dataType:'json',success:self.evalSuccess});return;};Notebook.Async.evalSuccess=function(response){var self=Notebook.Async;var t=Notebook.TreeBranch;var cellid=response.cellid;var incount='In['+response.count+']:';var outcount='Out['+response.count+']:';$('#'+cellid)[0].saved=true;$('#'+cellid)[0].numberLabel(incount);var cellstyle=response.cellstyle;var content=response.content;t.spawnOutputCellNode(cellid,cellstyle,content,outcount);$('#'+cellid)[0].evalResult();Notebook.Save._save(self.evalSaveSuccess,self.evalSaveError);};Notebook.Async.evalError=function(response){};Notebook.Async.evalSaveSuccess=function(response){};Notebook.Async.evalSaveError=function(response){};Notebook.Async.saveToDatabase=function(orderlist,cellsdata,success,error){var path=BASE_URL+'save';var cells=JSON.stringify(cellsdata);var data={'orderlist':orderlist,'cellsdata':cells};$.ajax({url:path,type:'POST',data:data,dataType:'json',success:success,error:error});};Notebook.Async.deleteCells=function(mainid,ids){var path=BASE_URL+'delete';var cellids=JSON.stringify(ids);var data={'cellids':cellids};};Notebook.Async.changeNotebookTitle=function(title,success,error){var path=BASE_URL+'change';var data={'newtitle':title};$.ajax({url:path,type:'POST',data:data,dataType:'json',success:success,error:error});};Notebook.Async.completeName=function(cellid,mode,input,success,error){var path=BASE_URL+'completer';var data={'cellid':cellid,'mode':mode,'input':input};$.ajax({url:path,type:'POST',data:data,dataType:'json',success:success,error:error});};Notebook.__init__.Async=function(){Notebook.Async.initialize();};Notebook.Delegator=function(nodeid){this.mode='normal';this.listener=nodeid;this.groups={};this.targets={};};Notebook.Delegator.prototype={init:function(){$(this.listener).bind('keydown',this,this.delegate);$(this.listener).bind('keypress',this,this.delegate);$(this.listener).bind('keyup',this,this.delegate);$(this.listener).bind('click',this,this.delegate);$(this.listener).bind('dblclick',this,this.delegate);$(this.listener).bind('mousedown',this,this.delegate);},registerAllActions:function(allactions){var self=this;$.each(allactions,function(group_selector,targets){self.registerGroup(group_selector);$.each(targets,function(target_selector,target_actions){self.registerTarget(group_selector,target_selector);self.registerTargetAction(target_selector,target_actions);})});},registerGroup:function(group_selector){this.groups[group_selector]={};},registerTarget:function(group_selector,target_selector){this.targets[target_selector]=group_selector;this.groups[group_selector][target_selector]=[];},registerTargetAction:function(target_selector,actions){var self=this;if(typeof(action)=='function'){var actions=[actions];}
var target_group=self.targets[target_selector];$.each(actions,function(i,action){self.groups[target_group][target_selector].push(action);});},delegate:function(e){var self=e.data;var target_selector=e.target.tagName.toLowerCase()+'.'+e.target.className;var target_group=self.targets[target_selector];if(target_group){var group_element=$(e.target).parents(target_group);e.groupNode=group_element[0];e.mode=self.mode;var acts=self.groups[target_group][target_selector];var returnstop;for(var a in acts){if(acts[a].test(e)){returnstop=acts[a].handler(e);}}
return;}
return;}};Notebook.Action=function(name){this.name=name;this.mode='normal';this.keyCodes=[[0,200]];this.button=0;this.shift=false;this.ctrl=false;this.alt=false;this.meta=false;this.preventDefault=false;this.stopPropagation=false;};Notebook.Action.prototype={test:function(e){if(this.testMode(e.mode)){if(this.testType(e.type)){if(this.testModKeys(e.shiftKey,e.ctrlKey,e.altKey)){if(this.testKeyCode(e.keyCode)){if(this.preventDefault){e.preventDefault();}
if(this.stopPropagation){e.stopPropagation();}
return true;}}}}
return false;},testMode:function(mode){if(this.mode==mode||this.mode=='all'){return true;}},testType:function(type){if(type==this.type){return true;}
return false;},testKeyCode:function(keyCode){for(var k in this.keyCodes){var curCodeType=typeof(this.keyCodes[k])
var curCode=this.keyCodes[k]
switch(curCodeType){case'number':if(curCode==keyCode){return true;}
break;case'object':if(keyCode>=curCode[0]&&keyCode<=curCode[1]){return true;}
break;default:break;}}
return false;},testModKeys:function(shift,ctrl,alt){if(this.shift=='maybe'){var shift='maybe';}
if(this.ctrl=='maybe'){var ctrl='maybe';}
if(this.alt=='maybe'){var alt='maybe';}
if(shift==this.shift&&ctrl==this.ctrl&&alt==this.alt){return true;}else{return false;}}};Notebook.ClickAction=function(name){this.name=name;this.mode='normal';this.type='click';this.button=0;this.shift=false;this.ctrl=false;this.alt=false;this.meta=false;this.preventDefault=false;this.stopPropagation=false;};Notebook.ClickAction.prototype={test:function(e){if(this.testMode(e.mode)){if(this.testType(e.type)){if(this.testModKeys(e.shiftKey,e.ctrlKey,e.altKey)){if(this.testButton(e.button)){if(this.preventDefault){e.preventDefault();}
if(this.stopPropagation){e.stopPropagation();}
return true;}}}}
return false;},testMode:function(mode){if(this.mode==mode||this.mode=='all'){return true;}},testType:function(type){if(type==this.type){return true;}
return false;},testButton:function(button){if(this.button==button){return true;}
return false;},testModKeys:function(shift,ctrl,alt){if(this.shift=='maybe'){var shift='maybe';}
if(this.ctrl=='maybe'){var ctrl='maybe';}
if(this.alt=='maybe'){var alt='maybe';}
if(shift==this.shift&&ctrl==this.ctrl&&alt==this.alt){return true;}else{return false;}}};bracketClick=new Notebook.ClickAction('braclick');bracketClick.type='click';bracketClick.handler=function(e){Notebook.bracketSelector.select(e.groupNode.id);};bracketSelectMore=new Notebook.ClickAction('bmore');bracketSelectMore.ctrl=true;bracketSelectMore.handler=function(e){Notebook.bracketSelector.selectMore(e.groupNode.id);};bracketDblClick=new Notebook.ClickAction('brackdblclk');bracketDblClick.type='dblclick';bracketDblClick.handler=function(e){e.groupNode.toggleOpen();};bracketRightDown=new Notebook.ClickAction('rightDown');bracketRightDown.type='mousedown';bracketRightDown.button=2;bracketRightDown.ctrl='maybe';bracketRightDown.meta='maybe';bracketRightDown.handler=function(e){var selectedQ=Notebook.bracketSelector.isSelected(e.groupNode.id);if(!selectedQ){Notebook.bracketSelector.select(e.groupNode.id);}};mainNullClick=new Notebook.ClickAction('nullclick');mainNullClick.type='mousedown';mainNullClick.handler=function(e){Notebook.bracketSelector.deselectAll();e.groupNode.setFocus();};cellContextMenu=new Notebook.ClickAction('context');cellContextMenu.type="contextmenu";cellContextMenu.button=2;cellContextMenu.stopPropagation=true;cellContextMenu.handler=function(e){};bottompadClick=new Notebook.ClickAction('botpad');bottompadClick.type='click';bottompadClick.handler=function(e){e.groupNode.focusFromBelow();};spawnKeydownAction=new Notebook.Action('spawnkeydown');spawnKeydownAction.keyCodes=[13,32,[48,57],[185,193],[219,222],[65,90]];spawnKeydownAction.type='keydown';spawnKeydownAction.shift='maybe';spawnKeydownAction.ctrl='maybe';spawnKeydownAction.handler=function(e){var node=Notebook.TreeBranch.spawnInputCellNode();if(e.groupNode.id=='topspawner'){Notebook.TreeBranch.putCellNodeAtTop(node);}else{Notebook.TreeBranch.putCellNodeAfter(e.groupNode.parentNode,node);}
node.setFocus();};evalAction=new Notebook.Action('eval');evalAction.keyCodes=[13];evalAction.shift=true;evalAction.type='keydown';evalAction.preventDefault=true;evalAction.handler=function(e){e.groupNode.evaluate();e.groupNode.focusDown();};stopevalAction=new Notebook.Action('eval');stopevalAction.keyCodes=[13];stopevalAction.shift=true;stopevalAction.type='keypress';stopevalAction.preventDefault=true;stopevalAction.handler=function(e){};cellTabAction=new Notebook.Action('celltab');cellTabAction.keyCodes=[9];cellTabAction.type='keydown';cellTabAction.preventDefault=true;cellTabAction.handler=function(e){var gid=e.groupNode.id;if(browser.OS=='Mac'&&!$.browser.opera){e.mode=e.groupNode.tab();}else if($.browser.mozilla||$.browser.msie){e.mode=e.groupNode.tab();}else if($.browser.mozilla){e.mode=e.groupNode.tab();};};tabcompleteExitAction=new Notebook.Action('tabexit');tabcompleteExitAction.keyCodes=[27,32,8]
tabcompleteExitAction.type='keydown';tabcompleteExitAction.mode='completing';tabcompleteExitAction.preventDefault=false;tabcompleteExitAction.handler=function(e){e.groupNode.completionExit();e.mode='normal';};cellTabFilter=new Notebook.Action('tabfilter');cellTabFilter.keyCodes=[9];cellTabFilter.type='keypress';cellTabFilter.mode='all';cellTabFilter.preventDefault=true;cellTabFilter.handler=function(e){};hackcellTabFilter=new Notebook.Action('tabfilter');hackcellTabFilter.keyCodes=[9];hackcellTabFilter.type='keyup';hackcellTabFilter.mode='all';hackcellTabFilter.preventDefault=true;hackcellTabFilter.handler=function(e){if(browser.OS=='Mac'||$.browser.opera){e.groupNode.parentNode.setFocus();e.groupNode.parentNode.tab();};};refineTabcompletion=new Notebook.Action('refinetab');refineTabcompletion.keyCodes=[8,[10,26],[28,31],[35,200]];refineTabcompletion.type='keyup';refineTabcompletion.mode='completing';refineTabcompletion.preventDefault=true;refineTabcompletion.handler=function(e){e.mode=e.groupNode.tabCompletion();};pageTabcompletions=new Notebook.Action('pagetabs');pageTabcompletions.keyCodes=[33,34];pageTabcompletions.type='keydown';pageTabcompletions.mode='completing';pageTabcompletions.preventDefault=true;pageTabcompletions.handler=function(e){Notebook.Completer.pageCompletions(e.keyCode);};adjustCellAction=new Notebook.Action('adjustcell');adjustCellAction.keyCodes=[8,[10,200]];adjustCellAction.shift='maybe';adjustCellAction.ctrl='maybe';adjustCellAction.type='keyup';adjustCellAction.handler=function(e){e.groupNode.adjustTextarea();};cellContentChange=new Notebook.Action('change');cellContentChange.keyCodes=[8,13,32,[48,57],[185,193],[65,90],[97,122]];cellContentChange.shift='maybe';cellContentChange.ctrl='maybe';cellContentChange.type='keydown';cellContentChange.handler=function(e){e.groupNode.saved=false;};cellUpArrowAction=new Notebook.Action('cellUpArrow');cellUpArrowAction.keyCodes=[38,63232];cellUpArrowAction.type='keypress';if($.browser.msie){cellUpArrowAction.type='keydown';};cellUpArrowAction.preventDefault=false;cellUpArrowAction.handler=function(e){e.groupNode.focusUp();};cellDownArrowAction=new Notebook.Action('cellDownArrow');cellDownArrowAction.keyCodes=[40,63233];cellDownArrowAction.type='keypress';if($.browser.msie){cellDownArrowAction.type='keydown';}
cellDownArrowAction.preventDefault=false;cellDownArrowAction.handler=function(e){e.groupNode.focusDown();};spawnerUpArrowAction=new Notebook.Action('spawnerUpArrow');spawnerUpArrowAction.keyCodes=[38,63232];spawnerUpArrowAction.type='keypress';if($.browser.msie){spawnerUpArrowAction.type='keydown';};spawnerUpArrowAction.preventDefault=true;spawnerUpArrowAction.handler=function(e){e.groupNode.focusUp();};spawnerDownArrowAction=new Notebook.Action('spawnerDownArrow');spawnerDownArrowAction.keyCodes=[40,63233];spawnerDownArrowAction.type='keypress';if($.browser.msie){spawnerDownArrowAction.type='keydown';};spawnerDownArrowAction.preventDefault=true;spawnerDownArrowAction.handler=function(e){e.groupNode.focusDown();};bracketKeyDelete=new Notebook.Action('backkeydel');bracketKeyDelete.keyCodes=[46];bracketKeyDelete.type='keydown';bracketKeyDelete.handler=function(e){Notebook.bracketSelector.deleteSelections();};Notebook.__init__.Delegator=function(){$('#notebook')[0].className='notebook';Notebook.delegator=new Notebook.Delegator('#notebook');Notebook.delegator.init();Notebook.delegator.registerAllActions({'div.spawner':{'textarea.spawninput':[spawnKeydownAction,hackcellTabFilter,spawnerDownArrowAction,spawnerUpArrowAction]},'div.cell input':{'textarea.input':[adjustCellAction,cellUpArrowAction,cellDownArrowAction,evalAction,stopevalAction,cellTabFilter,cellTabAction,pageTabcompletions,tabcompleteExitAction,refineTabcompletion,mainNullClick,cellContentChange,bracketRightDown],'span.bracketng':[bracketClick,bracketSelectMore,bracketRightDown,bracketDblClick,bracketKeyDelete]},'div.cell output':{'textarea.outputtext':[cellUpArrowAction,cellDownArrowAction,mainNullClick],'a.outputimage':[cellUpArrowAction,cellDownArrowAction],'img.outputimage':[mainNullClick]},'div.main':{'div.botpad':[bottompadClick]},'div.notebook':{'div.main':[mainNullClick]}});Notebook.auxdelegator=new Notebook.Delegator('#foot');Notebook.auxdelegator.init();Notebook.auxdelegator.registerAllActions({'div.foot':{'input.auxinput':[bracketKeyDelete]}});Notebook.bracketSelector=new Notebook.SelectionManager();$('div.contextMenu').hide();$('div.notebook').contextMenu('bracketMenu',{bindings:{'totitle':function(t){Notebook.bracketSelector.modifySelectionStyle('title');},'tosubtitle':function(t){Notebook.bracketSelector.modifySelectionStyle('subtitle');},'tosection':function(t){Notebook.bracketSelector.modifySelectionStyle('section');},'tosubsection':function(t){Notebook.bracketSelector.modifySelectionStyle('subsection');},'totext':function(t){Notebook.bracketSelector.modifySelectionStyle('text');},'toinput':function(t){Notebook.bracketSelector.modifySelectionStyle('input');}},onContextMenu:function(e){var t=e.target.tagName.toLowerCase()+'.'+e.target.className;if(t=='span.bracketng'||t=='textarea.input'){var groupNode=$(e.target).parents('div.cell');e.groupNode=groupNode;return true;}
return false;},onShowMenu:function(e,menu){return menu;},itemStyle:{'fontFamily':'arial, sans-serif','fontSize':'12px','padding':'3px 20px','border':'none'},itemHoverStyle:{'border':'none'},menuStyle:{'width':'150px','backgroundColor':'#f3f3f3'}});$('#titlecontainer').click(Util.startChangeTitle);$('#savebutton').click(function(e){Notebook.Save.save()});$('#saveclosebutton').click(function(e){Notebook.Save.saveAndClose()});$('#interruptbutton').click(function(e){Notebook.Async.signalKernel('interupt')});$('#killkernelbutton').click(function(e){Notebook.Async.signalKernel('kill')});};Notebook.DOM={};Notebook.DOM.topspawner=function(){var node=$.DIV({'class':'spawner','id':'topspawner'},$.TEXTAREA({'class':'spawninput'}));node.lastChild.readOnly=true;return node;};Notebook.DOM.mainDIV=function(){var node=$.DIV({'id':'main','class':'main'});return node;};Notebook.DOM.botPad=function(){var node=$.DIV({'id':'botpad','class':'botpad'});return node;};Notebook.DOM.newCell=function(){var self=Notebook.DOM;var node=$.DIV({'class':'cell'},self._label(),self._content(),self._bracket(),self._spawner());return node;};Notebook.DOM.newOutCell=function(){var self=Notebook.DOM;var node=$.DIV({'class':'cell'},self._label(),self._content(),self._bracket_output(),self._spawner());return node;};Notebook.DOM.groupCell=function(){var self=Notebook.DOM;var node=$.DIV({'class':'cell'},self._content(),self._bracket_group(),self._spawner());return node;};Notebook.DOM._label=function(){var node=$.SPAN({'class':'label'},$.DIV({'class':'number'}),$.DIV({'class':'tablight'}));return node;};Notebook.DOM._content=function(){var node=$.SPAN({'class':'contents'});return node;};Notebook.DOM._textarea=function(){var node=$.TEXTAREA({'class':'input','cols':'1','rows':'1'});return node;};Notebook.DOM._textoutput=function(){var node=$.TEXTAREA({'class':'outputtext','cols':'1','rows':'1'});return node;};Notebook.DOM._imageoutput=function(){return $.A({'class':'outputimage','href':'#'},$.IMG({'class':'outputimage'}));};Notebook.DOM._treebranch=function(){var node=$.DIV({'class':'ctreebranch'});return node;};Notebook.DOM._bracket=function(){var node=$.SPAN({'class':'bracketng'},$.IMG({'class':'bracketmaskimg','src':'/static/img/bracketslant.png'}));return node;};Notebook.DOM._bracket_output=function(){var node=$.SPAN({'class':'bracketng'},$.IMG({'class':'bracketmaskimg','src':'/static/img/bracketoutput.png'}));return node;};Notebook.DOM._bracket_group=function(){var node=$.SPAN({'class':'bracketng'});return node;};Notebook.DOM._spawner=function(){var node=$.DIV({'class':'spawner'},$.TEXTAREA({'class':'spawninput'}));node.lastChild.readOnly=true;return node;};Notebook.DOM.contextMenu=function(){return $.DIV({'class':'contextMenu','id':'bracketMenu'},$.UL(null,$.LI({'id':'totitle'},'Title'),$.LI({'id':'tosubtitle'},'Subtitle'),$.LI({'id':'tosection'},'Section'),$.LI({'id':'tosubsection'},'Subsection'),$.LI({'id':'totext'},'Text'),$.LI({'id':'toinput'},'Input'),$.LI({'id':'tooutput'},'Output')));};Notebook.dom=Notebook.DOM;Notebook.Save={};Notebook.Save.getUnsavedCellList=function(orderlist){function dosave(cellid,i){return!$('#'+cellid)[0].saved;}
var tosave=$.grep(orderlist,dosave);return tosave;};Notebook.Save.generateOrderList=function(){var cellnodes=$('div.cell:not(.group)');if(cellnodes.length>0){var orderlist=$.map(cellnodes,function(n,i){return $(n).attr('id');});}else{var orderlist=['none'];}
return orderlist;};Notebook.Save.generateCellData=function(cellids){var cellsdata={};for(c in cellids){var cellid=cellids[c];var cellnode=$('#'+cellid)[0];var cellstyle=cellnode.cellstyle;var content=cellnode.content();var props=JSON.stringify(cellnode.getProps());cellsdata[cellid]={'cellstyle':cellstyle,'content':content,'props':props};}
return cellsdata;};Notebook.Save._save=function(success,error){var self=Notebook.Save;var orderlist=self.generateOrderList();if(orderlist[0]!='none'){var tosave=self.getUnsavedCellList(orderlist);var cellsdata=self.generateCellData(tosave);Notebook.Save.tosave=tosave;Notebook.Async.saveToDatabase(orderlist,cellsdata,success,error);}else{success(true);}};Notebook.Save.save=function(){Notebook.Indicator.save();var self=Notebook.Save;self._save(self.saveSuccess,self.saveError);};Notebook.Save.saveAndClose=function(){Notebook.Indicator.save();var self=Notebook.Save;self._save(self.saveCloseSuccess,self.saveError);};Notebook.Save.saveSuccess=function(res){var self=Notebook.Save;Notebook.Indicator.saved();for(id in self.tosave){$('#'+self.tosave[id])[0].saved=true;}};Notebook.Save.saveCloseSuccess=function(res){window.close();};Notebook.Save.saveError=function(res){Notebook.Indicator.saveError();};Notebook.Load={};Notebook.Load.takeCellsData=function(nbobject){var orderlist=nbobject.orderlist.split(',');if(orderlist[0]=='orderlist'){return;}
var cellsdata=nbobject.cells;var nodes=[];for(c in orderlist){try{var cellid=orderlist[c];var cellstyle=cellsdata[cellid]['cellstyle'];var content=cellsdata[cellid]['content'];var props=cellsdata[cellid]['props'];var node=Notebook.TreeBranch.spawnCellNodeLoad(cellid,cellstyle,content,props);node.saved=true;nodes.push(node);}catch(err){continue;}}
Notebook.TreeBranch.putCellNodeAtTop(nodes);Notebook.TreeBranch.loadSieve(orderlist);$('img.outputimage').one('load',function(e){$(e.currentTarget).parents('div.cell.output')[0].adjustTextarea();});};Notebook.Spawner=function(){};Notebook.Spawner.prototype.setFocus=function(){this.firstChild.focus();$('#auxdisplay').html('spawner');};Notebook.Spawner.prototype.beBlured=function(){};Notebook.Spawner.prototype.focusUp=function(){this.parentNode.setFocus();};Notebook.Spawner.prototype.focusDown=function(){this.parentNode.focusNextCell();};Notebook.TreeBranch={};Notebook.TreeBranch.MAX_SECTION_LEVEL=5;Notebook.TreeBranch.INPUT_LEVEL=10;Notebook.TreeBranch.OUTPUT_LEVEL=11;Notebook.TreeBranch.TEXT_LEVEL=15;Notebook.TreeBranch.spawnCellNode=function(){var u=Util;var self=Notebook.TreeBranch;var cellnode=Notebook.dom.newCell();cellnode=$.extend(cellnode,Notebook.Cell.prototype);cellnode.id=u.uniqueId();return cellnode;};Notebook.TreeBranch.spawnOutCellNode=function(){var u=Util;var self=Notebook.TreeBranch;var cellnode=Notebook.dom.newOutCell();cellnode=$.extend(cellnode,Notebook.Cell.prototype);cellnode.id=u.uniqueId();return cellnode;};Notebook.TreeBranch.spawnCellNodeLoad=function(cellid,cellstyle,content,props){var self=Notebook.TreeBranch;var cellnode=self.spawnCellNode();cellnode.id=cellid;cellnode.setStyle(cellstyle);cellnode.setType();self.enableSpawner(cellnode);cellnode.content(content);return cellnode;};Notebook.TreeBranch.enableSpawner=function(node){if(!node.spawnerNode().enabled){$.extend(node.spawnerNode(),Notebook.Spawner.prototype);node.spawnerNode().enabled=true;return;}else{return;}};Notebook.TreeBranch.disableSpawner=function(node){$(node.spawnerNode()).hide();node.spawnerNode().enabled=false;};Notebook.TreeBranch.changeCell=function(style,node){var self=Notebook.TreeBranch;if(node.isHead()){var nodesbranch=node.getParentBranch();var nodesbranchsbranch=node.getParentBranch().getParentBranch();self.collapseBranch(nodesbranch);node.resetStyle(style);self.sieveBranch(nodesbranchsbranch);}else{var nodesbranch=node.getParentBranch();node.resetStyle(style);self.sieveBranch(nodesbranch);}
node.adjustTextarea();node.setFocus();return;};Notebook.TreeBranch.changeToTitle=function(node){Notebook.TreeBranch.changeCell('title',node);};Notebook.TreeBranch.changeToSubtitle=function(node){Notebook.TreeBranch.changeCell('subtitle',node);};Notebook.TreeBranch.changeToSection=function(node){Notebook.TreeBranch.changeCell('section',node);};Notebook.TreeBranch.changeToSubsection=function(node){Notebook.TreeBranch.changeCell('subsection',node);};Notebook.TreeBranch.changeToInput=function(node){Notebook.TreeBranch.changeCell('input',node);};Notebook.TreeBranch.putCellNodeAfter=function(oldersibling,node){var self=Notebook.TreeBranch;$(oldersibling).after(node);var branchesbranch=$(oldersibling)[0].getParentBranch().getParentBranch();self.collapseBranch($(oldersibling)[0].getParentBranch());self.sieveBranch(branchesbranch);$('img.bracketmaskimg').ifixpng('/static/img/pixel.gif');};Notebook.TreeBranch.putCellNodeAtTop=function(node){$('#main > :first-child').before(node);};Notebook.TreeBranch.removeCellNode=function(node){var self=Notebook.TreeBranch;var parentbranch=node.getParentBranch();$(node).remove();self.sieveBranch(parentbranch);};Notebook.TreeBranch.deleteCellNode=function(node){var self=Notebook.TreeBranch;var branchesbranch=$(node)[0].getParentBranch().getParentBranch();self.collapseBranch($(node)[0].getParentBranch());$(node).remove();self.sieveBranch(branchesbranch);};Notebook.TreeBranch.setOutputCell=function(outputnode,inputid){var self=Notebook.TreeBranch;var node=$('#'+inputid)[0];if(node.isHead()){self.removeCellNode(node.nextCell());}
self.putCellNodeAfter(node,outputnode);var oid=outputnode.id;$('img.outputimage').one('load',oid,function(e){$('#'+e.data)[0].adjustTextarea();});outputnode.adjustTextarea();outputnode.saved=true;if($('#auxdisplay').html()=='spawner'){outputnode.spawnerNode().setFocus();}
self.sieveBranch(node.getParentBranch());};Notebook.TreeBranch.setNullOutputCell=function(inputid){var self=Notebook.TreeBranch;var node=$('#'+inputid)[0];if(node.isHead()){self.removeCellNode(node.nextCell());}
self.sieveBranch(node.getParentBranch());};Notebook.TreeBranch.spawnOutputCellNode=function(id,cellstyle,content,count){var self=Notebook.TreeBranch;if(content.length>0){var node=self.spawnOutCellNode();node.setStyle(cellstyle);node.id=id+'o';node.setType();self.enableSpawner(node);node.content(content);node.numberLabel(count);self.setOutputCell(node,id);return;}else{self.setNullOutputCell(id);}};Notebook.TreeBranch.spawnInputCellNode=function(){var self=Notebook.TreeBranch;var node=self.spawnCellNode();node.setStyle('input');node.setType();self.enableSpawner(node);return node;};Notebook.TreeBranch.spawnTitleCellNode=function(){var self=Notebook.TreeBranch;var node=self.spawnCellNode();node.setStyle('title');};Notebook.TreeBranch.loadSieve=function(orderlist){var self=Notebook.TreeBranch;for(cell in orderlist){var cellid=orderlist[cell];var cellnode=$('#'+cellid)[0];cellnode.adjustTextarea();var nodes=self.getNextCellsToAbsorb(cellnode);if(nodes.length>0){var branchnode=self.branchAtNode(cellnode);}}
$('img.bracketmaskimg').ifixpng();};Notebook.TreeBranch.sieveBranch=function(branchnode){var self=Notebook.TreeBranch;var branchlevel=branchnode.getCellLevel();var headnode=branchnode.contentNode().firstChild;var curnode=headnode;var curlevel=headnode.getCellLevel();while(curnode.nextCell()){var nextnode=curnode.nextCell();var nextlevel=nextnode.getCellLevel();if(nextlevel<=branchlevel){var nodes=self.collapseBranchAtNode(nextnode);$(branchnode).after(nodes);var parentbranch=branchnode.getParentBranch();return self.sieveBranch(parentbranch);}else if(nextlevel<curlevel){if(!nextnode.isGroup()){var newbranch=self.branchAtNode(nextnode);if(newbranch.isGroup()){nextnode=newbranch;nextlevel=nextnode.getCellLevel();self.sieveBranch(newbranch);}}}else if(nextlevel>curlevel){curnode=self.absorbNode(curnode,nextnode);}
curnode=nextnode;curlevel=nextlevel;}};Notebook.TreeBranch.sieveOnChange=function(changednode){var self=Notebook.TreeBranch;if(changednode.isHead()){self.collapseBranch(changednode.getParentBranch());}};Notebook.TreeBranch.absorbNode=function(absorbernode,nodetoabsorb){var self=Notebook.TreeBranch;if(absorbernode.isHead()){return absorbernode;}
if(!absorbernode.isGroup()){var absorbernode=self.branchAtNode(absorbernode);}else{self.growBranch(absorbernode);}
return absorbernode;};Notebook.TreeBranch.growBranch=function(branchnode){var self=Notebook.TreeBranch;var nodes=self.getNextSiblingsToAbsorb(branchnode);nodes=$(nodes).remove();$(branchnode.contentNode()).append(nodes);return;};Notebook.TreeBranch.branchAtNode=function(node){var self=Notebook.TreeBranch;var nodes=self.getNextSiblingsToAbsorb(node);nodes=$(nodes).remove();if(nodes.length>0){var groupnode=self.makeGroupNode();$(node).replaceWith(groupnode);groupnode.appendChildCells(nodes);groupnode.prependChildCells(node);$('img.bracketmaskimg').ifixpng();return groupnode;}else{return node;}};Notebook.TreeBranch.makeGroupNode=function(){var u=Util;var self=Notebook.TreeBranch;var node=Notebook.dom.groupCell();node=$.extend(node,Notebook.Cell.prototype);node.id=u.uniqueId();node.setAsGroup();return node;};Notebook.TreeBranch.collapseBranch=function(node){var self=Notebook.TreeBranch;if(node.id=='main'){return;};var headnode=node.contentNode().firstChild;var nodes=self.collapseBranchAtNode(headnode);$(node).after(nodes);$(node).remove();return;};Notebook.TreeBranch.collapseBranchAtNode=function(node){var nodes=$(node).add($(node).nextAll()).remove();return nodes;};Notebook.TreeBranch.getAllNextSiblingNodes=function(node){var curnode=node;var nodes=[];while(curnode.nextCell()){nodes.push(curnode.nextCell());curnode=curnode.nextCell();}
return nodes;};Notebook.TreeBranch.getNextSiblingsToAbsorb=function(node){var self=Notebook.TreeBranch;var curnode=node;var matchlevel=node.getCellLevel();var nodes=[];if(matchlevel<self.MAX_SECTION_LEVEL){while(curnode.nextCell()){if(curnode.nextCell().getCellLevel()>matchlevel){nodes.push(curnode.nextCell());curnode=curnode.nextCell();}else{break;}}}else if(matchlevel==self.INPUT_LEVEL){while(curnode.nextCell()){if(curnode.nextCell().getCellLevel()==self.OUTPUT_LEVEL){nodes.push(curnode.nextCell());curnode=curnode.nextCell();}else{break;}}}
return nodes;};Notebook.TreeBranch.getNextCellsToAbsorb=function(node){var self=Notebook.TreeBranch;var nodes=[];if(!node.isHead()){var curnode=node;var matchlevel=node.getCellLevel();if(matchlevel<self.MAX_SECTION_LEVEL){while(curnode.nextCell()){if(curnode.nextCell().getCellLevel()>matchlevel){nodes.push(curnode.nextCell());curnode=curnode.nextCell();}else{break;}}}else if(matchlevel==self.INPUT_LEVEL){while(curnode.nextCell()){if(curnode.nextCell().getCellLevel()==self.OUTPUT_LEVEL){nodes.push(curnode.nextCell());curnode=curnode.nextCell();}else{break;}}}}
return nodes;};Notebook.Completer={init:function(){var self=Notebook.Completer;self.completing=false;self.cellid=null;self.tocomplete='';},test:function(cellid,tomatch){var self=Notebook.Completer;var cell=$('#'+cellid)[0];var REname=/([a-zA-Z_][a-zA-Z_0-9]*)$/;var REattribute=/([a-zA-Z_][a-zA-Z_0-9]*[.]+[a-zA-Z_.0-9]*)$/;var REintrospect=/([a-zA-Z_][a-zA-Z_0-9]*)\?/;var name_match=tomatch.match(REname);var attribute_match=tomatch.match(REattribute);var introspect_match=tomatch.match(REintrospect);if(attribute_match){cell.completing=true;cell.setCompletingLabel('attribute');cell.tomatch=attribute_match[1];self.completeAttribute(cellid,attribute_match[1]);return'completing';}
if(name_match){cell.completing=true;cell.setCompletingLabel('name');cell.tomatch=name_match[1];self.completeName(cellid,name_match[1]);return'completing';}
if(introspect_match){return;}
return false;},completionTable:function(){return $.DIV({'id':'completions','class':'completions'});},completionItem:function(item){return $.SPAN({'class':'completionword'},item);},makeTable:function(wordlist){var max=Math.max.apply(null,$.map(wordlist,function(s){return s.length}));var px=parseInt($("textarea").css("font-size"));var w=$(window).width();var h=$(window).height();var td_width=px*max;var num_td=Math.floor(w/td_width)+1;var dlen=wordlist.length;var fin=[];var temp=[];var count=1;var tbody=$.each(wordlist,function(i,val){var node=$.TD({'class':'completionword'},val);$(node).mousedown(Notebook.Completer.completionClickHandler);temp.push(node);if(count==num_td){fin.push($.TR({},temp));temp=[];count=0;}
count+=1;if(i==dlen-1){fin.push($.TR({},temp));tb=$.TBODY({},fin);}});return fin;},completionTable2:function(cellid){var elem=$.TABLE({'id':'completions','class':'completions'},[$.THEAD({},''),$.TBODY({},'')]);var pos=$("#"+cellid).position();console.log(pos);var topval=pos.top+15;var leftval=4*12+pos.left;return $(elem).css("top",topval+"px").css("left",leftval+"px");},completionTable3:function(cellid){var elem=$.TABLE({'id':'completions','class':'completions'},[$.THEAD({},''),$.TBODY({},'')]);return elem;},completionInitialize:function(cellid,mode){var self=Notebook.Completer;if(self.completing){if(mode==self.mode){return false;}else{self.mode=mode;return true;}}
Notebook.delegator.mode='completing';$($('#'+cellid)[0].textareaNode()).blur(function(e){e.preventDefault();Notebook.Completer.completionExit();});self.cellid=cellid;self.mode=mode;self.completing=true;var comtable=self.completionTable3(cellid);$('#foot').append(comtable);$('#foot').height('20%');$('#notebook').css('bottom','20%');var nheight=$('#notebook').height();var nscrolltop=$('#notebook').scrollTop();var celloffset=$('#'+cellid).offset()['top'];if(celloffset-nheight>-20){$('#notebook').scrollTop(nscrolltop+celloffset-nheight);}
return true;},completionExit:function(){var self=Notebook.Completer;if(self.completing){$('#completions').remove();$('#foot').height('1px');$('#notebook').css('bottom','0');self.completing=false;self.mode='none';$('#'+self.cellid)[0].completing=false;$('#'+self.cellid)[0].setCompletingLabel('off');Notebook.delegator.mode='normal';}},completeName:function(cellid,tocomplete){var self=Notebook.Completer;var mode='name';if(self.completionInitialize(cellid,mode)){Notebook.Async.completeName(cellid,mode,tocomplete,self.completeNameCallback,self.completeNameError);return;}else{self.refineCompletions(tocomplete);return;}},completeAttribute:function(cellid,tocomplete){var self=Notebook.Completer;var mode='attr';var input=tocomplete;if(self.completionInitialize(cellid,mode)){Notebook.Async.completeName(cellid,mode,tocomplete,self.completeNameCallback,self.completeNameError);return;}else{self.refineCompletions(tocomplete);return;}},completeNameCallback:function(response){var self=Notebook.Completer;var completions=eval(response.completions);self.completions=completions;self.displayCompletions(completions);},completeNameError:function(result){},displayCompletions:function(completions){var self=Notebook.Completer;if(self.singleMatchQ(completions)){var wordnodes=self.makeTable(completions);$('#completions tbody').remove();$('#completions').append(wordnodes);return;}},refineCompletions:function(tocomplete){var self=Notebook.Completer;var chk=function(elm,i){return elm.substr(0,tocomplete.length)==tocomplete;}
self.refined_completions=$.grep(self.completions,function(elm,i){return elm.substr(0,tocomplete.length)==tocomplete;});self.displayCompletions(self.refined_completions);},singleMatchQ:function(completions){var self=Notebook.Completer;if(completions.length>1){return true;}else if(completions.length==1){self.completionExit();var completion_sufix=completions[0].substr($('#'+self.cellid)[0].tomatch.length);$('#'+self.cellid)[0].contentInsert(completion_sufix,$('#'+self.cellid)[0].selectionStart);return false;}else{self.completionExit();return false;}},pageCompletions:function(keyCode){console.info('pageCompletions',keyCode);},completionClickHandler:function(e){Notebook.Completer.singleMatchQ([e.currentTarget.textContent]);},completionBlurHandler:function(e){var self=Notebook.Completer;self.completionExit();}};Notebook.__init__.Completer=function(){Notebook.Completer.init();};Util={};Util.nbTitle=function(title){$('#statictitle').innerHTML=title;$('#statictitle').enabled=false;return;};Util.changeTitlePrompt=function(title){var node=$.FORM({'id':'changetitleform'},$.INPUT({'id':'changetitle','type':'text','value':title}));return node;};Util.startChangeTitle=function(e){var self=Util;if(!$('#titlecontainer')[0].enabled){$('#titlecontainer')[0].enabled=true;$('#statictitle').hide();var title=$('#statictitle').text();var node=Util.changeTitlePrompt(title);$(node.firstChild).blur(self.blurChangeTitle);$(node).submit(self.exitChangeTitle);$('#titlecontainer').append(node);node.firstChild.focus();return;}else{}};Util.blurChangeTitle=function(e){Util.exitChangeTitle();return;};Util.exitChangeTitle=function(){var curtitle=document.title;var newtitle=$('#changetitle')[0].value;$('#changetitleform').unbind('blur');$('#changetitle').unbind('submit');$('#changetitleform').remove();$('#statictitle').show();$('#titlecontainer')[0].enabled=false;if(newtitle!=curtitle){Notebook.Async.changeNotebookTitle(newtitle,Util.changeTitleCallback,Util.changeTitleError);}};Util.changeTitleCallback=function(response){var system=$("#logo").text();var newtitle="Codenode - "+response.title;document.title=newtitle;$('#statictitle')[0].innerHTML=response.title;};Util.changeTitleError=function(result){};Util.createKeyQ=function(keyCode){var k=keyCode;if(k==13||k==27||k==32||((k>185)&&(k<193))||((k>218)&&(k<223))||((k>47)&&(k<58))||((k>64)&&(k<91))||((k>95)&&(k<106))||((k>105)&&(k<111))){return true;}
return false;};Util.uniqueId=function(){var d=new Date();id=d.getTime()+Math.random().toString().substr(2,8);return id;};Util.printList=function(){var plist=$("#printers");plist.toggle();plist.hover(function(){},function(){setTimeout(function(){plist.hide()},500);});};Util.init=function(){$("#print_list").click(Util.printList);};if(!this.JSON){JSON=function(){function f(n){return n<10?'0'+n:n;}
Date.prototype.toJSON=function(){return this.getUTCFullYear()+'-'+
f(this.getUTCMonth()+1)+'-'+
f(this.getUTCDate())+'T'+
f(this.getUTCHours())+':'+
f(this.getUTCMinutes())+':'+
f(this.getUTCSeconds())+'Z';};var m={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'};function stringify(value,whitelist){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case'string':return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c;}
c=a.charCodeAt();return'\\u00'+Math.floor(c/16).toString(16)+
(c%16).toString(16);})+'"':'"'+value+'"';case'number':return isFinite(value)?String(value):'null';case'boolean':case'null':return String(value);case'object':if(!value){return'null';}
if(typeof value.toJSON==='function'){return stringify(value.toJSON());}
a=[];if(typeof value.length==='number'&&!(value.propertyIsEnumerable('length'))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i],whitelist)||'null');}
return'['+a.join(',')+']';}
if(whitelist){l=whitelist.length;for(i=0;i<l;i+=1){k=whitelist[i];if(typeof k==='string'){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+':'+v);}}}}else{for(k in value){if(typeof k==='string'){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+':'+v);}}}}
return'{'+a.join(',')+'}';}}
return{stringify:stringify,parse:function(text,filter){var j;function walk(k,v){var i,n;if(v&&typeof v==='object'){for(i in v){if(Object.prototype.hasOwnProperty.apply(v,[i])){n=walk(i,v[i]);if(n!==undefined){v[i]=n;}}}}
return filter(k,v);}
if(/^[\],:{}\s]*$/.test(text.replace(/\\./g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+text+')');return typeof filter==='function'?walk('',j):j;}
throw new SyntaxError('parseJSON');}};}();}
(function($){$.dimensions={version:'@VERSION'};$.each(['Height','Width'],function(i,name){$.fn['inner'+name]=function(){if(!this[0])return;var torl=name=='Height'?'Top':'Left',borr=name=='Height'?'Bottom':'Right';return this.css('display')!='none'?this[0]['client'+name]:num(this,name.toLowerCase())+num(this,'padding'+torl)+num(this,'padding'+borr);};$.fn['outer'+name]=function(options){if(!this[0])return;var torl=name=='Height'?'Top':'Left',borr=name=='Height'?'Bottom':'Right';options=$.extend({margin:false},options||{});var val=this.css('display')!='none'?this[0]['offset'+name]:num(this,name.toLowerCase())
+num(this,'border'+torl+'Width')+num(this,'border'+borr+'Width')
+num(this,'padding'+torl)+num(this,'padding'+borr);return val+(options.margin?(num(this,'margin'+torl)+num(this,'margin'+borr)):0);};});$.each(['Left','Top'],function(i,name){$.fn['scroll'+name]=function(val){if(!this[0])return;return val!=undefined?this.each(function(){this==window||this==document?window.scrollTo(name=='Left'?val:$(window)['scrollLeft'](),name=='Top'?val:$(window)['scrollTop']()):this['scroll'+name]=val;}):this[0]==window||this[0]==document?self[(name=='Left'?'pageXOffset':'pageYOffset')]||$.boxModel&&document.documentElement['scroll'+name]||document.body['scroll'+name]:this[0]['scroll'+name];};});$.fn.extend({position:function(){var left=0,top=0,elem=this[0],offset,parentOffset,offsetParent,results;if(elem){offsetParent=this.offsetParent();offset=this.offset();parentOffset=offsetParent.offset();offset.top-=num(elem,'marginTop');offset.left-=num(elem,'marginLeft');parentOffset.top+=num(offsetParent,'borderTopWidth');parentOffset.left+=num(offsetParent,'borderLeftWidth');results={top:offset.top-parentOffset.top,left:offset.left-parentOffset.left};}
return results;},offsetParent:function(){var offsetParent=this[0].offsetParent;while(offsetParent&&(!/^body|html$/i.test(offsetParent.tagName)&&$.css(offsetParent,'position')=='static'))
offsetParent=offsetParent.offsetParent;return $(offsetParent);}});function num(el,prop){return parseInt($.curCSS(el.jquery?el[0]:el,prop,true))||0;};})(jQuery);(function(){var fieldSelection={getSelection:function(){var e=this.jquery?this[0]:this;return(('selectionStart'in e&&function(){var l=e.selectionEnd-e.selectionStart;return{start:e.selectionStart,end:e.selectionEnd,length:l,text:e.value.substr(e.selectionStart,l)};})||(document.selection&&function(){e.focus();var r=document.selection.createRange();if(r==null){return{start:0,end:e.value.length,length:0}}
var re=e.createTextRange();var rc=re.duplicate();re.moveToBookmark(r.getBookmark());rc.setEndPoint('EndToStart',re);return{start:rc.text.length,end:rc.text.length+r.text.length,length:r.text.length,text:r.text};})||function(){return{start:0,end:e.value.length,length:0};})();},replaceSelection:function(){var e=this.jquery?this[0]:this;var text=arguments[0]||'';return(('selectionStart'in e&&function(){e.value=e.value.substr(0,e.selectionStart)+text+e.value.substr(e.selectionEnd,e.value.length);return this;})||(document.selection&&function(){e.focus();document.selection.createRange().text=text;return this;})||function(){e.value+=text;return this;})();}};jQuery.each(fieldSelection,function(i){jQuery.fn[i]=this;});})();(function($){$.fn.jqm=function(p){var o={zIndex:3000,overlay:50,overlayClass:'jqmOverlay',closeClass:'jqmClose',trigger:'.jqModal',ajax:false,target:false,modal:false,toTop:false,onShow:false,onHide:false,onLoad:false};return this.each(function(){if(this._jqm)return;s++;this._jqm=s;H[s]={c:$.extend(o,p),a:false,w:$(this).addClass('jqmID'+s),s:s};o.trigger&&$(this).jqmAddTrigger(o.trigger);});};$.fn.jqmAddClose=function(e){return HS(this,e,'jqmHide');};$.fn.jqmAddTrigger=function(e){return HS(this,e,'jqmShow');};$.fn.jqmShow=function(t){return this.each(function(){!H[this._jqm].a&&$.jqm.open(this._jqm,t)});};$.fn.jqmHide=function(t){return this.each(function(){H[this._jqm].a&&$.jqm.close(this._jqm,t)});};$.jqm={hash:{},open:function(s,t){var h=H[s],c=h.c,cc='.'+c.closeClass,z=/^\d+$/.test(h.w.css('z-index'))&&h.w.css('z-index')||c.zIndex,o=$('<div></div>').css({height:'100%',width:'100%',position:'fixed',left:0,top:0,'z-index':z-1,opacity:c.overlay/100});h.t=t;h.a=true;h.w.css('z-index',z);if(c.modal){!A[0]&&F('bind');A.push(s);o.css('cursor','wait');}
else if(c.overlay>0)h.w.jqmAddClose(o);else o=false;h.o=(o)?o.addClass(c.overlayClass).prependTo('body'):false;if(ie6&&$('html,body').css({height:'100%',width:'100%'})&&o){o=o.css({position:'absolute'})[0];for(var y in{Top:1,Left:1})o.style.setExpression(y.toLowerCase(),"(_=(document.documentElement.scroll"+y+" || document.body.scroll"+y+"))+'px'");}
if(c.ajax){var r=c.target||h.w,u=c.ajax,r=(typeof r=='string')?$(r,h.w):$(r),u=(u.substr(0,1)=='@')?$(t).attr(u.substring(1)):u;r.load(u,function(){c.onLoad&&c.onLoad.call(this,h);cc&&h.w.jqmAddClose($(cc,h.w));O(h);});}
else cc&&h.w.jqmAddClose($(cc,h.w));c.toTop&&h.o&&h.w.before('<span id="jqmP'+h.w[0]._jqm+'"></span>').insertAfter(h.o);c.onShow&&c.onShow(h);h.w.show();O(h);return false;},close:function(s){var h=H[s];h.a=false;if(h.c.modal){A.pop();!A[0]&&F('unbind');}
h.c.toTop&&h.o&&$('#jqmP'+h.w[0]._jqm).after(h.w).remove();if(h.c.onHide)h.c.onHide(h);else{h.w.hide()&&h.o&&h.o.remove()}return false;}};var s=0,H=$.jqm.hash,A=[],ie6=$.browser.msie&&($.browser.version=="6.0"),i=$('<iframe src="javascript:false;document.write(\'\');" class="jqm"></iframe>').css({opacity:0}),O=function(h){if(ie6)h.o&&h.o.html('<p style="width:100%;height:100%"/>').prepend(i)||(!$('iframe.jqm',h.w)[0]&&h.w.prepend(i));f(h);},f=function(h){try{$(':input:visible',h.w)[0].focus();}catch(e){}},F=function(t){$()[t]("keypress",x)[t]("keydown",x)[t]("mousedown",x);},x=function(e){var h=H[A[A.length-1]],r=(!$(e.target).parents('.jqmID'+h.s)[0]);r&&f(h);return!r;},HS=function(w,e,y){var s=[];w.each(function(){s.push(this._jqm)});$(e).each(function(){if(this[y])$.extend(this[y],s);else{this[y]=s;$(this).click(function(){for(var i in{jqmShow:1,jqmHide:1})for(var s in this[i])if(H[this[i][s]])H[this[i][s]].w[i](this);return false;});}});return w;};})(jQuery);
